clear;

%% Global Variables
%%% Directory
global dir
global dir_s
global result_dir

%%% Load parameters
%{ 
global N_FILE
global P_FILE
global FAO_FILE
global AEZ_FILE
global PAEZ_FILE

%%% New portfolio file names
global CN_MAP_FILE
global CR_MAP_FILE
global HARVST_FILE
global HARVST_AEZ_REG_FILE
global PROD_AEZ_REG_FILE
global PRODUCT_FILE
global PRICE_FILE
global TRADE_FILE
global BAL_FILE

%%% Mapping and dimensions
global co_dim   % country dimension
global cr_dim   % crop dimension
global CN_MAP   % country one-to-one mapping
global CR_MAP   % crop one-to-one mapping
global CN_ARY   % unique set of country
global CR_ARY   % unique set of crop
global CR_IND   % newrop index used for calculation excluding pasture
global MAPPING  % mapping variable that contains CN_MAP,CR_MAP,CN_ARY, and CR_ARY 

%%% Base year
global uniYrs   % total trade coverage
global baseyr   % base calendar year
global yr_base  % base calendar year index
global tradeyrs % base calendar trade year
global tyr_base % base calendar trade year index
global yr_trd   % trade year index in total year coverage
global aez      % aez1-18 for each region
%}
%% Directory Setting
dir = 'C:\Users\gyao\Google Drive\SAM_CMT\'; %***
dir_s = '\';                                              %***
result_dir = [dir dir_s 'CodeFinal' dir_s 'Graphs07142020' dir_s];

%% Load Original Parameters
N_FILE = 'basic_N_SAM.mat';                               %***
%P_FILE = 'basic_P_SAM.mat';                              %***
FAO_FILE = 'basic_FAO_SAM.mat';                           %***
AEZ_FILE = 'harvst_area_aez_base.csv';
PAEZ_FILE = 'prod_aez_base.csv';

load([dir 'Inputs' dir_s N_FILE]);                        %***
%load([dir 'Inputs' dir_s P_FILE]);                       %***
load([dir 'Inputs' dir_s FAO_FILE]);                      %***

%% Load New Portfolios
CN_MAP_FILE = 'FAO_GTAP_6.csv';                           %***
CR_MAP_FILE = 'Crop_Mapping_FAO_GTAP_6.csv';              %***
HARVST_FILE = 'harvstcom_0912_Soy.csv';                %***
PRODUCT_FILE = 'qo_0912_Soy.csv';                   %***
PRICE_FILE = 'ps_0912_Soy.csv';                     %***
TRADE_FILE = 'qxs_0912_Soy.csv';                    %***
BAL_FILE = 'trade_balance_0912_Soy.csv';               %***
HARVST_AEZ_REG_FILE = 'harvst_aez_reg_0912_Soy.csv';
PROD_AEZ_REG_FILE = 'prod_aez_reg_0912_Soy.csv';

CR_IND = [1:10];                                          %***

%% Set base year
uniYrs = 1961:2016;
baseyr = 2014;                                            %***
yr_base = find(uniYrs == baseyr);                         %***
tradeyrs = 1986:1:2016;                                   %***
tyr_base = find(tradeyrs == baseyr);                      %***
yr_trd = find(uniYrs>1985 & uniYrs<2017);                 %***
for n = 1:18
    aez{n} = ['AEZ' num2str(n)];
end

%% Load Country Mapping
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s CN_MAP_FILE];
fid = fopen(fname)

fmt = '%f %s %f %s %s %f';                                %***
hd_no = 6;                                                %***

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt,'delimiter',',');
fclose(fid);

        CN_MAP = string(Raw_Data{1,5});                   %***
        CN_MAP_NO = Raw_Data{1,6};                        %***

%% Load Crop Mapping
clear fname;
%%% Load GTAP mapping
fname = [dir 'Application' dir_s 'Inputs' dir_s 'Crop_Mapping_FAO_GTAP_6.csv'];
fid = fopen(fname);

fmt = ' %f %s %s %f ';                                    %***
hd_no = 4;                                                %***

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);

        CR_MAP = string(Raw_Data{1,3});                   %***
        CR_MAP_NO = Raw_Data{1,4};                        %***
%% Load AEZ division -- harvested area
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s AEZ_FILE];
fid = fopen(fname);

fmt = ' %s %s %f %f %f %f %f %f %f %f %f %f %f ';            %***
hd_no = 13;

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);

AEZ_RAW = cell2mat(Raw_Data(3:13));
HARVST_AEZ_PRC(1:6,1:18,1:11) = nan;
for cn = 1:1:6
    cnend = cn*18;
    cnstd = (cn - 1)*18 + 1;
    HARVST_AEZ_PRC(cn,:,:) = AEZ_RAW(cnstd:cnend,:);
end

%% Load AEZ division -- production
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s PAEZ_FILE];
fid = fopen(fname);

fmt = ' %s %s %f %f %f %f %f %f %f %f %f %f %f ';            %***
hd_no = 13;

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);

AEZ_RAW = cell2mat(Raw_Data(3:13));
PROD_AEZ_PRC(1:6,1:18,1:11) = nan;

for cn = 1:1:6
      cnend = cn*18;
      cnstd = (cn - 1)*18 + 1;
      PROD_AEZ_PRC(cn,:,:) = AEZ_RAW(cnstd:cnend,:);
end

%% Load Simulated results

%%% Harvested area
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s HARVST_FILE];
fid = fopen(fname);

fmt = ' %s %f %f %f %f %f %f %f %f %f %f %f ';            %***
hd_no = 12;                                               %***

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);
      
        %%% GTAP mapping
        CN_ARY = string(Raw_Data{1,1});                   %***
        CR_ARY = string(Raw_header{1,1}(2:12));           %***

        co_dim = length(CN_ARY);                          %***
        cr_dim = length(CR_ARY);                          %***

        MAPPING = {CR_MAP,CN_MAP,CR_ARY,CN_ARY};
        %%% harvested area changes and new harvested area
        harvst_changes = cell2mat(Raw_Data(2:12));        %***

        
% Production
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s PRODUCT_FILE];
fid = fopen(fname)

fmt = ' %s %f %f %f %f %f %f %f %f %f %f %f ';            %***
hd_no = 12;                                               %***

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);
%%% production area changes and new harvested area
        prod_changes = cell2mat(Raw_Data(2:12));          %***

        
%%% Price
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s PRICE_FILE];
fid = fopen(fname)

fmt = ' %s %f %f %f %f %f %f %f %f %f %f %f ';            %***
hd_no = 12;                                               %***

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);

%%% production area changes and new harvested area
        price_changes = cell2mat(Raw_Data(2:12));         %***

%%% trade balance results
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s BAL_FILE];
fid = fopen(fname)

fmt = ' %s %f %f %f %f %f %f %f %f %f %f %f ';            %***
hd_no = 12;                                               %***

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);

trade_bal_delta = cell2mat(Raw_Data(2:12)); %%% million US$
trade_bal_delta = trade_bal_delta .* 1000000;

trade_bal_deltaco = nansum(trade_bal_delta(:,CR_IND),2); 

%%% trade results
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s TRADE_FILE];
fid = fopen(fname);

fmt = ' %s %s %f %f %f %f %f %f';                         %***
hd_no = 8;                                                %***

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);

        crop_trade_list = string(Raw_Data{1,1});          %***
        imp_trade_list = string(Raw_Data{1,2});           %***
        trade_changes = cell2mat(Raw_Data(3:8));          %***

        %%% Rearrange trade data                          %***
        for co = 1:1:co_dim
            im = find(imp_trade_list == CN_ARY(co));
            bi_trade_changes(1:cr_dim,1:length(yr_base),co,1:co_dim) = trade_changes(im,1:co_dim);
        end

%%% Harvested Area AEZ
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s HARVST_AEZ_REG_FILE];
fid = fopen(fname);

fmt = ' %s %s %f %f %f %f %f %f %f %f %f %f %f ';            %***
hd_no = 13;

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);

AEZ_RAW = cell2mat(Raw_Data(3:13));
HARVST_AEZ_PCHANGE(1:6,1:18,1:11) = nan;
for cn = 1:1:6
    cnend = cn*18;
    cnstd = (cn - 1)*18 + 1;
    HARVST_AEZ_PCHANGE(cn,:,:) = AEZ_RAW(cnstd:cnend,:);
end

%%% Production AEZ
clear fname;
fname = [dir 'Application' dir_s 'Inputs' dir_s PROD_AEZ_REG_FILE];
fid = fopen(fname);

fmt = ' %s %s %f %f %f %f %f %f %f %f %f %f %f ';            %***
hd_no = 13;

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);

AEZ_RAW = cell2mat(Raw_Data(3:13));
PROD_AEZ_PCHANGE(1:6,1:18,1:11) = nan;
for cn = 1:1:6
      cnend = cn*18;
      cnstd = (cn - 1)*18 + 1;
    PROD_AEZ_PCHANGE(cn,:,:) = AEZ_RAW(cnstd:cnend,:);
end

%% FAO and Portfolio Data Processing
addpath([dir 'functions'])                                %***



%%% Add another function to deal with Harvested area, production, price,
%%% and Yield 
AreaH_FAO = Var_Generate_Data(AreaH_FAO);
Product_FAO = Var_Generate_Data(Product_FAO);
Price_FAO = Var_Generate_Data(Price_FAO);
Yield_FAO = Var_Generate_Data(Yield_FAO);

AreaH_FAO_Agg = Var_Agg_SIMPLE(AreaH_FAO,MAPPING);
Product_FAO_Agg = Var_Agg_SIMPLE(Product_FAO,MAPPING);
Price_FAO_Agg = Var_Agg_WGT(Price_FAO,Product_FAO,MAPPING);
Yield_FAO_Agg = Var_Agg_WGT(Yield_FAO,AreaH_FAO,MAPPING);

%%% Calculate AEZ Harvested Area Changes
AreaH_AEZ_FAO_Agg(1:6,1:18,1:11,1:56) = nan;
for yr = 1:1:56
    for az = 1:1:18
    AreaH_AEZ_FAO_Agg(:,az,:,yr) = squeeze(AreaH_FAO_Agg(1:6,1:11,yr)).* squeeze(HARVST_AEZ_PRC(1:6,az,1:11));
    end
end

%%% Production AEZ
Prod_AEZ_FAO_Agg(1:6,1:18,1:11,1:56) = nan;
for yr = 1:1:56
    for az = 1:1:18
    Prod_AEZ_FAO_Agg(:,az,:,yr) = squeeze(Product_FAO_Agg(1:6,1:11,yr)).* squeeze(PROD_AEZ_PRC(1:6,az,1:11));
    end
end

save([dir 'Inputs' dir_s 'basic_aez.mat'],'HARVST_AEZ_PCHANGE','HARVST_AEZ_PRC','AreaH_AEZ_FAO_Agg','PROD_AEZ_PCHANGE','PROD_AEZ_PRC','Prod_AEZ_FAO_Agg');

%%% Aggregate original trade data
%%% Trade aggregation
ImTrdQnt_Agg(1:cr_dim,1:56,1:co_dim,1:co_dim) = nan;
ImTrdQnt_Agg(:,yr_trd,:,:) = Var_Agg_TRD(ImTrdQnt,MAPPING);

%%% new portfolio
harvst_new = AreaH_FAO_Agg(:,:,yr_base).*(1 + harvst_changes./100);     %***
prod_new = Product_FAO_Agg(:,:,yr_base).*(1 + prod_changes./100);       %***
price_new = Price_FAO_Agg(:,:,yr_base).*(1 + price_changes./100);       %***
trade_new= ImTrdQnt_Agg(:,yr_base,:,:).*(1+bi_trade_changes./100);      %***
harvst_aez_new = AreaH_AEZ_FAO_Agg(:,:,:,yr_base).*(1+HARVST_AEZ_PCHANGE./100);
prod_aez_new = Prod_AEZ_FAO_Agg(:,:,:,yr_base).*(1+PROD_AEZ_PCHANGE./100);

original_port = {AreaH_FAO_Agg,Product_FAO_Agg,Price_FAO_Agg,ImTrdQnt_Agg};
new_port = {harvst_new, prod_new, price_new, trade_new};
year_port = {uniYrs,baseyr,yr_base};

%% SAM_CMT Model
[
portf.HARVST_Delta,             portf.HARVST_DeltaCO,         portf.HARVST_DeltaGB,...
portf.HARVST_Delta1,            portf.HARVST_DeltaCO1,        portf.HARVST_DeltaGB1,...
Nitr.Ninput.Ninput_kgkm_Agg,    Nitr.Nyield.Nyield_kgkm_Agg,   Nitr.Nsur.Nsur_kgkm_Agg, Nitr.NUE.NUE_Agg,...
Nitr.Ninput.Ninput_kg_Exp,      Nitr.Ninput.Ninput_kg_Agg,	Nitr.Ninput.Ninput_kg_Delta,...
Nitr.Nyield.Nyield_kg_Exp,      Nitr.Nyield.Nyield_kg_Agg,	Nitr.Nyield.Nyield_kg_Delta,...
Nitr.Nsur.Nsur_kg_Exp,          Nitr.Nsur.Nsur_kg_Agg,	Nitr.Nsur.Nsur_kg_Delta,...
Nitr.Ninput.Ninput_kg_ExpCO,	Nitr.Ninput.Ninput_kg_AggCO,	Nitr.Ninput.Ninput_kg_DeltaCO,...
Nitr.Nyield.Nyield_kg_ExpCO,	Nitr.Nyield.Nyield_kg_AggCO,	Nitr.Nyield.Nyield_kg_DeltaCO,...
Nitr.Nsur.Nsur_kg_ExpCO,        Nitr.Nsur.Nsur_kg_AggCO,	Nitr.Nsur.Nsur_kg_DeltaCO,...
Nitr.Ninput.Ninput_kgkm_ExpCO,	Nitr.Ninput.Ninput_kgkm_AggCO,	Nitr.Ninput.Ninput_kgkm_DeltaCO,...
Nitr.Nyield.Nyield_kgkm_ExpCO,	Nitr.Nyield.Nyield_kgkm_AggCO,	Nitr.Nyield.Nyield_kgkm_DeltaCO,...
Nitr.Nsur.Nsur_kgkm_ExpCO,      Nitr.Nsur.Nsur_kgkm_AggCO,	Nitr.Nsur.Nsur_kgkm_DeltaCO,...
Nitr.NUE.NUE_ExpCO,             Nitr.NUE.NUE_AggCO,	Nitr.NUE.NUE_DeltaCO,...
Nitr.Ninput.Ninput_kg_ExpGB,	Nitr.Ninput.Ninput_kg_AggGB,	Nitr.Ninput.Ninput_kg_DeltaGB,...
Nitr.Nyield.Nyield_kg_ExpGB,	Nitr.Nyield.Nyield_kg_AggGB,	Nitr.Nyield.Nyield_kg_DeltaGB,...
Nitr.Nsur.Nsur_kg_ExpGB,	Nitr.Nsur.Nsur_kg_AggGB,	Nitr.Nsur.Nsur_kg_DeltaGB,...
Nitr.Ninput.Ninput_kgkm_ExpGB,	Nitr.Ninput.Ninput_kgkm_AggGB,	Nitr.Ninput.Ninput_kgkm_DeltaGB,...
Nitr.Nyield.Nyield_kgkm_ExpGB,	Nitr.Nyield.Nyield_kgkm_AggGB,	Nitr.Nyield.Nyield_kgkm_DeltaGB,...
Nitr.Nsur.Nsur_kgkm_ExpGB,	Nitr.Nsur.Nsur_kgkm_AggGB,	Nitr.Nsur.Nsur_kgkm_DeltaGB,...
Nitr.NUE.NUE_ExpGB,	Nitr.NUE.NUE_AggGB,	Nitr.NUE.NUE_DeltaGB,...
Nitr.Vir.Narea_Vir_Exp,	Nitr.Vir.Narea_Vir,	Nitr.Vir.Narea_Vir_Delta,...
Nitr.Vir.Ninput_Vir_Exp,	Nitr.Vir.Ninput_Vir,	Nitr.Vir.Ninput_Vir_Delta,...
Nitr.Vir.Nsur_Vir_Exp,	Nitr.Vir.Nsur_Vir,	Nitr.Vir.Nsur_Vir_Delta,...
Nitr.Alt.Narea_Alt_Exp,	Nitr.Alt.Narea_Alt,	Nitr.Alt.Narea_Alt_Delta,...
Nitr.Alt.Ninput_Alt_Exp,	Nitr.Alt.Ninput_Alt,	Nitr.Alt.Ninput_Alt_Delta,...
Nitr.Alt.Nsur_Alt_Exp,	Nitr.Alt.Nsur_Alt,	Nitr.Alt.Nsur_Alt_Delta,...
Nitr.Vir.BiNarea_Vir,	Nitr.Vir.BiNsur_Vir,	Nitr.Vir.BiNinput_Vir,...
Nitr.Alt.BiNarea_Alt,	Nitr.Alt.BiNsur_Alt,	Nitr.Alt.BiNinput_Alt,...
Nitr.Vir.BiNarea_Vir_CR,	Nitr.Vir.BiNsur_Vir_CR,	Nitr.Vir.BiNinput_Vir_CR,...
Nitr.Alt.BiNarea_Alt_CR,	Nitr.Alt.BiNsur_Alt_CR,	Nitr.Alt.BiNinput_Alt_CR,...
Nitr.Vir.BiNarea_Vir_ExpCR,	Nitr.Vir.BiNsur_Vir_ExpCR,	Nitr.Vir.BiNinput_Vir_ExpCR,...
Nitr.Alt.BiNarea_Alt_ExpCR,	Nitr.Alt.BiNsur_Alt_ExpCR,	Nitr.Alt.BiNinput_Alt_ExpCR,...
Nitr.Vir.BiNarea_Vir_DeltaCR,	Nitr.Vir.BiNsur_Vir_DeltaCR,	Nitr.Vir.BiNinput_Vir_DeltaCR,...
Nitr.Alt.BiNarea_Alt_DeltaCR,	Nitr.Alt.BiNsur_Alt_DeltaCR,	Nitr.Alt.BiNinput_Alt_DeltaCR,...
Nitr.Vir.Narea_Vir_CO,      Nitr.Vir.Nsur_Vir_CO,       Nitr.Vir.Ninput_Vir_CO,...
Nitr.Alt.Narea_Alt_CO,      Nitr.Alt.Nsur_Alt_CO,       Nitr.Alt.Ninput_Alt_CO,...
Nitr.Vir.Narea_Vir_GB,      Nitr.Vir.Nsur_Vir_GB,       Nitr.Vir.Ninput_Vir_GB,...
Nitr.Alt.Narea_Alt_GB,      Nitr.Alt.Nsur_Alt_GB,       Nitr.Alt.Ninput_Alt_GB,...
Nitr.Vir.Narea_Vir_DeltaCO,	Nitr.Vir.Nsur_Vir_DeltaCO,	Nitr.Vir.Ninput_Vir_DeltaCO,...
Nitr.Vir.Narea_Vir_DeltaGB,	Nitr.Vir.Nsur_Vir_DeltaGB,	Nitr.Vir.Ninput_Vir_DeltaGB,...
Nitr.Alt.Narea_Alt_DeltaCO,	Nitr.Alt.Nsur_Alt_DeltaCO,	Nitr.Alt.Ninput_Alt_DeltaCO,...
Nitr.Alt.Narea_Alt_DeltaGB,	Nitr.Alt.Nsur_Alt_DeltaGB,	Nitr.Alt.Ninput_Alt_DeltaGB,...
Phos.Ninput.Ninput_kgkm_Agg,   Phos.Pyield.Pyield_kgkm_Agg,   Phos.Psur.Psur_kgkm_Agg, Phos.PUE.PUE_Agg,...
Phos.Pinput.Pinput_kg_Exp,	Phos.Pinput.Pinput_kg_Agg,	Phos.Pinput.Pinput_kg_Delta,...
Phos.Pyield.Pyield_kg_Exp,	Phos.Pyield.Pyield_kg_Agg,	Phos.Pyield.Pyield_kg_Delta,...
Phos.Psur.Psur_kg_Exp,	Phos.Psur.Psur_kg_Agg,	Phos.Psur.Psur_kg_Delta,...
Phos.Pres.Pres_kg_Exp,	Phos.Pres.Pres_kg_Agg,	Phos.Pres.Pres_kg_Delta,...
Phos.Pinput.Pinput_kg_ExpCO,	Phos.Pinput.Pinput_kg_AggCO,	Phos.Pinput.Pinput_kg_DeltaCO,...
Phos.Pyield.Pyield_kg_ExpCO,	Phos.Pyield.Pyield_kg_AggCO,	Phos.Pyield.Pyield_kg_DeltaCO,...
Phos.Psur.Psur_kg_ExpCO,	Phos.Psur.Psur_kg_AggCO,	Phos.Psur.Psur_kg_DeltaCO,...
Phos.Pres.Pres_kg_ExpCO,	Phos.Pres.Pres_kg_AggCO,	Phos.Pres.Pres_kg_DeltaCO,...
Phos.Pinput.Pinput_kgkm_ExpCO,	Phos.Pinput.Pinput_kgkm_AggCO,	Phos.Pinput.Pinput_kgkm_DeltaCO,...
Phos.Pyield.Pyield_kgkm_ExpCO,	Phos.Pyield.Pyield_kgkm_AggCO,	Phos.Pyield.Pyield_kgkm_DeltaCO,...
Phos.Psur.Psur_kgkm_ExpCO,	Phos.Psur.Psur_kgkm_AggCO,	Phos.Psur.Psur_kgkm_DeltaCO,...
Phos.Pres.Pres_kgkm_ExpCO,	Phos.Pres.Pres_kgkm_AggCO,	Phos.Pres.Pres_kgkm_DeltaCO,...
Phos.PUE.PUE_ExpCO,             Phos.PUE.PUE_AggCO,	Phos.PUE.PUE_DeltaCO,...
Phos.Pinput.Pinput_kg_ExpGB,	Phos.Pinput.Pinput_kg_AggGB,	Phos.Pinput.Pinput_kg_DeltaGB,...
Phos.Pyield.Pyield_kg_ExpGB,	Phos.Pyield.Pyield_kg_AggGB,	Phos.Pyield.Pyield_kg_DeltaGB,...
Phos.Psur.Psur_kg_ExpGB,	Phos.Psur.Psur_kg_AggGB,	Phos.Psur.Psur_kg_DeltaGB,...
Phos.Pres.Pres_kg_ExpGB,	Phos.Pres.Pres_kg_AggGB,	Phos.Pres.Pres_kg_DeltaGB,...
Phos.Pinput.Pinput_kgkm_ExpGB,	Phos.Pinput.Pinput_kgkm_AggGB,	Phos.Pinput.Pinput_kgkm_DeltaGB,...
Phos.Pyield.Pyield_kgkm_ExpGB,	Phos.Pyield.Pyield_kgkm_AggGB,	Phos.Pyield.Pyield_kgkm_DeltaGB,...
Phos.Psur.Psur_kgkm_ExpGB,	Phos.Psur.Psur_kgkm_AggGB,	Phos.Psur.Psur_kgkm_DeltaGB,...
Phos.Pres.Pres_kgkm_ExpGB,	Phos.Pres.Pres_kgkm_AggGB,	Phos.Pres.Pres_kgkm_DeltaGB,...
Phos.PUE.PUE_ExpGB,	Phos.PUE.PUE_AggGB,	Phos.PUE.PUE_DeltaGB,...
Phos.Vir.Parea_Vir_Exp,	Phos.Vir.Parea_Vir,	Phos.Vir.Parea_Vir_Delta,...
Phos.Vir.Pinput_Vir_Exp,	Phos.Vir.Pinput_Vir,	Phos.Vir.Pinput_Vir_Delta,...
Phos.Vir.Psur_Vir_Exp,	Phos.Vir.Psur_Vir,	Phos.Vir.Psur_Vir_Delta,...
Phos.Alt.Parea_Alt_Exp,	Phos.Alt.Parea_Alt,	Phos.Alt.Parea_Alt_Delta,...
Phos.Alt.Pinput_Alt_Exp,	Phos.Alt.Pinput_Alt,	Phos.Alt.Pinput_Alt_Delta,...
Phos.Alt.Psur_Alt_Exp,	Phos.Alt.Psur_Alt,	Phos.Alt.Psur_Alt_Delta,...
Phos.Vir.BiParea_Vir,	Phos.Vir.BiPsur_Vir,	Phos.Vir.BiPinput_Vir,...
Phos.Alt.BiParea_Alt,	Phos.Alt.BiPsur_Alt,	Phos.Alt.BiPinput_Alt,...
Phos.Vir.BiParea_Vir_CR,	Phos.Vir.BiPsur_Vir_CR,	Phos.Vir.BiPinput_Vir_CR,...
Phos.Alt.BiParea_Alt_CR,	Phos.Alt.BiPsur_Alt_CR,	Phos.Alt.BiPinput_Alt_CR,...
Phos.Vir.BiParea_Vir_ExpCR,	Phos.Vir.BiPsur_Vir_ExpCR,	Phos.Vir.BiPinput_Vir_ExpCR,...
Phos.Alt.BiParea_Alt_ExpCR,	Phos.Alt.BiPsur_Alt_ExpCR,	Phos.Alt.BiPinput_Alt_ExpCR,...
Phos.Vir.BiParea_Vir_DeltaCR,	Phos.Vir.BiPsur_Vir_DeltaCR,	Phos.Vir.BiPinput_Vir_DeltaCR,...
Phos.Alt.BiParea_Alt_DeltaCR,	Phos.Alt.BiPsur_Alt_DeltaCR,	Phos.Alt.BiPinput_Alt_DeltaCR,...
Phos.Vir.Parea_Vir_CO,	Phos.Vir.Psur_Vir_CO,	Phos.Vir.Pinput_Vir_CO,...
Phos.Alt.Parea_Alt_CO,	Phos.Alt.Psur_Alt_CO,	Phos.Alt.Pinput_Alt_CO,...
Phos.Vir.Parea_Vir_GB,	Phos.Vir.Psur_Vir_GB,	Phos.Vir.Pinput_Vir_GB,...
Phos.Alt.Parea_Alt_GB,	Phos.Alt.Psur_Alt_GB,	Phos.Alt.Pinput_Alt_GB,...
Phos.Vir.Parea_Vir_DeltaCO,	Phos.Vir.Psur_Vir_DeltaCO,	Phos.Vir.Pinput_Vir_DeltaCO,...
Phos.Vir.Parea_Vir_DeltaGB,	Phos.Vir.Psur_Vir_DeltaGB,	Phos.Vir.Pinput_Vir_DeltaGB,...
Phos.Alt.Parea_Alt_DeltaCO,	Phos.Alt.Psur_Alt_DeltaCO,	Phos.Alt.Pinput_Alt_DeltaCO,...
Phos.Alt.Parea_Alt_DeltaGB,	Phos.Alt.Psur_Alt_DeltaGB,	Phos.Alt.Pinput_Alt_DeltaGB,...
Wat.h2oDeplete.h2oDeplete_Agg,     Wat.h2oDeplete.h2oDeplete_AggCO,   Wat.h2oDeplete.h2oDeplete_AggGB,...
Wat.h2oDeplete.h2oDeplete_ExpCO,   Wat.h2oDeplete.h2oDeplete_ExpGB,...
Wat.h2oDeplete.h2oDeplete_3d_L_Agg,	Wat.h2oDeplete.h2oDeplete_L_AggCO,	Wat.h2oDeplete.h2oDeplete_L_AggGB...
Wat.h2oDeplete.h2oDeplete_3d_L_Exp,	Wat.h2oDeplete.h2oDeplete_L_ExpCO,	Wat.h2oDeplete.h2oDeplete_L_ExpGB,...
Wat.h2oDeplete.h2oDeplete_L_Delta,	Wat.h2oDeplete.h2oDeplete_L_DeltaCO,	Wat.h2oDeplete.h2oDeplete_L_DeltaGB,...
Wat.WUE.WUE_AggCO,	Wat.WUE.WUE_N_AggCO,    Wat.WUE.WUE_Agg, Wat.WUE.WUE_N_Agg,...	
Wat.WUE.WUE_ExpCO,	Wat.WUE.WUE_N_ExpCO,...	
Wat.WUE.WUE_DeltaCO,	Wat.WUE.WUE_N_DeltaCO,...	
Wat.WUE.WUE_AggGB,	Wat.WUE.WUE_N_AggGB,...	
Wat.WUE.WUE_ExpGB,	Wat.WUE.WUE_N_ExpGB,...	
Wat.WUE.WUE_DeltaGB,         Wat.WUE.WUE_N_DeltaGB,...	
Wat.Blue.BlueW_Agg,     Wat.Blue.BlueW_AggCO,   Wat.Blue.BlueW_AggGB,...
Wat.Blue.BlueW_ExpCO,   Wat.Blue.BlueW_ExpGB,...
Wat.Blue.BlueW_L_Agg,        Wat.Blue.BlueW_L_AggCO,   	Wat.Blue.BlueW_L_AggGB...
Wat.Blue.BlueW_L_Exp,        Wat.Blue.BlueW_L_ExpCO,   	Wat.Blue.BlueW_L_ExpGB,...
Wat.Blue.BlueW_L_Delta,      Wat.Blue.BlueW_L_DeltaCO,              Wat.Blue.BlueW_L_DeltaGB,...
Wat.BWUE.BWUE_AggCO,         Wat.BWUE.BWUE_N_AggCO,                 Wat.BWUE.BWUE_Agg,            Wat.BWUE.BWUE_N_Agg,...
Wat.BWUE.BWUE_ExpCO,         Wat.BWUE.BWUE_N_ExpCO,...
Wat.BWUE.BWUE_DeltaCO,       Wat.BWUE.BWUE_N_DeltaCO,...
Wat.BWUE.BWUE_AggGB,         Wat.BWUE.BWUE_N_AggGB,...
Wat.BWUE.BWUE_ExpGB,         Wat.BWUE.BWUE_N_ExpGB,...
Wat.BWUE.BWUE_DeltaGB,       Wat.BWUE.BWUE_N_DeltaGB,... 
AEZS.Level.Nsur_kg_AEZ_Agg,    AEZS.Level.Nsur_kg_AEZ_AggCO,    AEZS.Level.Nsur_kg_AEZ_AggGB,...
AEZS.Level.Nsur_kg_AEZ_Exp,    AEZS.Level.Nsur_kg_AEZ_ExpCO,    AEZS.Level.Nsur_kg_AEZ_ExpGB,...
AEZS.Level.Nsur_kg_AEZ_Delta,  AEZS.Level.Nsur_kg_AEZ_DeltaCO,  AEZS.Level.Nsur_kg_AEZ_DeltaGB,...
AEZS.Level.Psur_kg_AEZ_Agg,    AEZS.Level.Psur_kg_AEZ_AggCO,    AEZS.Level.Psur_kg_AEZ_AggGB,...
AEZS.Level.Psur_kg_AEZ_Exp,    AEZS.Level.Psur_kg_AEZ_ExpCO,    AEZS.Level.Psur_kg_AEZ_ExpGB,...
AEZS.Level.Psur_kg_AEZ_Delta,  AEZS.Level.Psur_kg_AEZ_DeltaCO,  AEZS.Level.Psur_kg_AEZ_DeltaGB,...            
AEZS.Level.h2oDeplete_L_AEZ_Agg,    AEZS.Level.h2oDeplete_L_AEZ_AggCO,    AEZS.Level.h2oDeplete_L_AEZ_AggGB,...
AEZS.Level.h2oDeplete_L_AEZ_Exp,    AEZS.Level.h2oDeplete_L_AEZ_ExpCO,    AEZS.Level.h2oDeplete_L_AEZ_ExpGB,...
AEZS.Level.h2oDeplete_L_AEZ_Delta,  AEZS.Level.h2oDeplete_L_AEZ_DeltaCO,  AEZS.Level.h2oDeplete_L_AEZ_DeltaGB,... 
AEZS.Level.BlueW_L_AEZ_Agg,    AEZS.Level.BlueW_L_AEZ_AggCO,    AEZS.Level.BlueW_L_AEZ_AggGB,...
AEZS.Level.BlueW_L_AEZ_Exp,    AEZS.Level.BlueW_L_AEZ_ExpCO,    AEZS.Level.BlueW_L_AEZ_ExpGB,...
AEZS.Level.BlueW_L_AEZ_Delta,  AEZS.Level.BlueW_L_AEZ_DeltaCO,  AEZS.Level.BlueW_L_AEZ_DeltaGB,...
AEZS.Intensity.Nsur_kgkm_AEZ_Agg,    AEZS.Intensity.Nsur_kgkm_AEZ_AggCO,    AEZS.Intensity.Nsur_kgkm_AEZ_AggGB,...
AEZS.Intensity.Nsur_kgkm_AEZ_Exp,    AEZS.Intensity.Nsur_kgkm_AEZ_ExpCO,    AEZS.Intensity.Nsur_kgkm_AEZ_ExpGB,...
AEZS.Intensity.Nsur_kgkm_AEZ_Delta,  AEZS.Intensity.Nsur_kgkm_AEZ_DeltaCO,  AEZS.Intensity.Nsur_kgkm_AEZ_DeltaGB,...
AEZS.Intensity.Nsur_Vir_AEZ_kgkm_Agg,    AEZS.Intensity.Nsur_Vir_AEZ_kgkm_Exp,  AEZS.Intensity.Nsur_Vir_AEZ_kgkm_Delta,...
AEZS.Intensity.Nsur_Vir_AEZ_kgkm_AggCO,  AEZS.Intensity.Nsur_Vir_AEZ_kgkm_ExpCO, AEZS.Intensity.Nsur_Vir_AEZ_kgkm_DeltaCO,...
AEZS.Intensity.Nsur_Vir_AEZ_kgkm_AggGB,  AEZS.Intensity.Nsur_Vir_AEZ_kgkm_ExpGB, AEZS.Intensity.Nsur_Vir_AEZ_kgkm_DeltaGB,...
AEZS.Intensity.Nsur_Alt_AEZ_kgkm_Agg,    AEZS.Intensity.Nsur_Alt_AEZ_kgkm_Exp,  AEZS.Intensity.Nsur_Alt_AEZ_kgkm_Delta,...
AEZS.Intensity.Nsur_Alt_AEZ_kgkm_AggCO,  AEZS.Intensity.Nsur_Alt_AEZ_kgkm_ExpCO, AEZS.Intensity.Nsur_Alt_AEZ_kgkm_DeltaCO,...
AEZS.Intensity.Nsur_Alt_AEZ_kgkm_AggGB,  AEZS.Intensity.Nsur_Alt_AEZ_kgkm_ExpGB, AEZS.Intensity.Nsur_Alt_AEZ_kgkm_DeltaGB,...
AEZS.Intensity.Psur_kgkm_AEZ_Agg,    AEZS.Intensity.Psur_kgkm_AEZ_AggCO,    AEZS.Intensity.Psur_kgkm_AEZ_AggGB,...
AEZS.Intensity.Psur_kgkm_AEZ_Exp,    AEZS.Intensity.Psur_kgkm_AEZ_ExpCO,    AEZS.Intensity.Psur_kgkm_AEZ_ExpGB,...
AEZS.Intensity.Psur_kgkm_AEZ_Delta,  AEZS.Intensity.Psur_kgkm_AEZ_DeltaCO,  AEZS.Intensity.Psur_kgkm_AEZ_DeltaGB,... 
AEZS.Intensity.Psur_Vir_AEZ_kgkm_Agg,    AEZS.Intensity.Psur_Vir_AEZ_kgkm_Exp,  AEZS.Intensity.Psur_Vir_AEZ_kgkm_Delta,...
AEZS.Intensity.Psur_Vir_AEZ_kgkm_AggCO,  AEZS.Intensity.Psur_Vir_AEZ_kgkm_ExpCO, AEZS.Intensity.Psur_Vir_AEZ_kgkm_DeltaCO,...
AEZS.Intensity.Psur_Vir_AEZ_kgkm_AggGB,  AEZS.Intensity.Psur_Vir_AEZ_kgkm_ExpGB, AEZS.Intensity.Psur_Vir_AEZ_kgkm_DeltaGB,...
AEZS.Intensity.Psur_Alt_AEZ_kgkm_Agg,    AEZS.Intensity.Psur_Alt_AEZ_kgkm_Exp,  AEZS.Intensity.Psur_Alt_AEZ_kgkm_Delta,...
AEZS.Intensity.Psur_Alt_AEZ_kgkm_AggCO,  AEZS.Intensity.Psur_Alt_AEZ_kgkm_ExpCO, AEZS.Intensity.Psur_Alt_AEZ_kgkm_DeltaCO,...
AEZS.Intensity.Psur_Alt_AEZ_kgkm_AggGB,  AEZS.Intensity.Psur_Alt_AEZ_kgkm_ExpGB, AEZS.Intensity.Psur_Alt_AEZ_kgkm_DeltaGB,...
AEZS.Intensity.h2oDeplete_Lkm_AEZ_Agg,    AEZS.Intensity.h2oDeplete_Lkm_AEZ_AggCO,    AEZS.Intensity.h2oDeplete_Lkm_AEZ_AggGB,...
AEZS.Intensity.h2oDeplete_Lkm_AEZ_Exp,    AEZS.Intensity.h2oDeplete_Lkm_AEZ_ExpCO,    AEZS.Intensity.h2oDeplete_Lkm_AEZ_ExpGB,...
AEZS.Intensity.h2oDeplete_Lkm_AEZ_Delta,  AEZS.Intensity.h2oDeplete_Lkm_AEZ_DeltaCO,  AEZS.Intensity.h2oDeplete_Lkm_AEZ_DeltaGB,... 
AEZS.Intensity.BlueW_Lkm_AEZ_Agg,    AEZS.Intensity.BlueW_Lkm_AEZ_AggCO,    AEZS.Intensity.BlueW_Lkm_AEZ_AggGB,...
AEZS.Intensity.BlueW_Lkm_AEZ_Exp,    AEZS.Intensity.BlueW_Lkm_AEZ_ExpCO,    AEZS.Intensity.BlueW_Lkm_AEZ_ExpGB,...
AEZS.Intensity.BlueW_Lkm_AEZ_Delta,  AEZS.Intensity.BlueW_Lkm_AEZ_DeltaCO,  AEZS.Intensity.BlueW_Lkm_AEZ_DeltaGB,...
Econ.Ag.Ag_Rev_Agg,	Econ.Ag.Ag_Rev_AggCO,	Econ.Ag.Ag_Rev_Delta,...
Econ.Ag.Ag_Rev_Exp,	Econ.Ag.Ag_Rev_ExpCO,	Econ.Ag.Ag_Rev_DeltaCO,...
Econ.Nsur_DC_US_min,     Econ.Nsur_DC_US_max,     Econ.Nsur_DC_US_avg,...
Econ.Nsur_DC_CN_min,     Econ.Nsur_DC_CN_max,     Econ.Nsur_DC_CN_avg,...
Econ.Nsur_DC_US_min_Exp,     Econ.Nsur_DC_US_max_Exp,     Econ.Nsur_DC_US_avg_Exp,...
Econ.Nsur_DC_CN_min_Exp,     Econ.Nsur_DC_CN_max_Exp,     Econ.Nsur_DC_CN_avg_Exp,...  
Econ.Nsur_DC_US_min_Delta,   Econ.Nsur_DC_US_max_Delta,   Econ.Nsur_DC_US_avg_Delta,...
Econ.Nsur_DC_CN_min_Delta,   Econ.Nsur_DC_CN_max_Delta,   Econ.Nsur_DC_CN_avg_Delta,...
Soc.SSR.SSR_AggCO,	Soc.SSR.SSR_AggCO_max,	Soc.SSR.SSR_AggCO_min,...
Soc.SSR.SSR_ExpCO,	Soc.SSR.SSR_ExpCO_max,	Soc.SSR.SSR_ExpCO_min,...
Soc.SSR.SSR_N_AggCO,	Soc.SSR.SSR_N_AggCO_max,	Soc.SSR.SSR_N_AggCO_min,...
Soc.SSR.SSR_N_ExpCO,	Soc.SSR.SSR_N_ExpCO_max,	Soc.SSR.SSR_N_ExpCO_min,...
Soc.SSR.SSR_Delta,	Soc.SSR.SSR_N_Delta,...	
Nutri.Calor.CalorProd_Agg,	Nutri.Prot.ProtProd_Agg,	Nutri.Fat.FatProd_Agg,...
Nutri.Calor.CalorProd_Exp,	Nutri.Prot.ProtProd_Exp,	Nutri.Fat.FatProd_Exp,...
Nutri.Calor.CalorProd_Delta,	Nutri.Prot.ProtProd_Delta,	Nutri.Fat.FatProd_Delta,...
Nutri.Calor.CalorProd_AggCO,	Nutri.Prot.ProtProd_AggCO,	Nutri.Fat.FatProd_AggCO,...
Nutri.Calor.CalorProd_ExpCO,	Nutri.Prot.ProtProd_ExpCO,	Nutri.Fat.FatProd_ExpCO,...
Nutri.Calor.CalorProd_DeltaCO,	Nutri.Prot.ProtProd_DeltaCO,	Nutri.Fat.FatProd_DeltaCO,...
Nutri.Calor.CalorImTrdQnt_Agg,	Nutri.Prot.ProtImTrdQnt_Agg,	Nutri.Fat.FatImTrdQnt_Agg,...
Nutri.Calor.CalorImTrdQnt_Exp,	Nutri.Prot.ProtImTrdQnt_Exp,	Nutri.Fat.FatImTrdQnt_Exp,...
Nutri.Calor.CalorImTrdQnt_Delta,	Nutri.Prot.ProtImTrdQnt_Delta,	Nutri.Fat.FatImTrdQnt_Delta,...
Nutri.Calor.CalorExport_Agg,	Nutri.Prot.ProtExport_Agg,	Nutri.Fat.FatExport_Agg,...
Nutri.Calor.CalorImport_Agg,	Nutri.Prot.ProtImport_Agg,	Nutri.Fat.FatImport_Agg,...
Nutri.Calor.CalorNetImp_Agg,	Nutri.Prot.ProtNetImp_Agg,	Nutri.Fat.FatNetImp_Agg,...
Nutri.Calor.CalorPNIm_Agg,	Nutri.Prot.ProtPNIm_Agg,	Nutri.Fat.FatPNIm_Agg,...
Nutri.Calor.CalorExport_Exp,	Nutri.Prot.ProtExport_Exp,	Nutri.Fat.FatExport_Exp,...
Nutri.Calor.CalorImport_Exp,	Nutri.Prot.ProtImport_Exp,	Nutri.Fat.FatImport_Exp,...
Nutri.Calor.CalorNetImp_Exp,	Nutri.Prot.ProtNetImp_Exp,	Nutri.Fat.FatNetImp_Exp,...
Nutri.Calor.CalorPNIm_Exp,	Nutri.Prot.ProtPNIm_Exp,	Nutri.Fat.FatPNIm_Exp,...
Nutri.Calor.CalorExport_Delta,	Nutri.Prot.ProtExport_Delta,	Nutri.Fat.FatExport_Delta,...
Nutri.Calor.CalorImport_Delta,	Nutri.Prot.ProtImport_Delta,	Nutri.Fat.FatImport_Delta,...
Nutri.Calor.CalorNetImp_Delta,	Nutri.Prot.ProtNetImp_Delta,	Nutri.Fat.FatNetImp_Delta,...
Nutri.Calor.CalorPNIm_Delta,	Nutri.Prot.ProtPNIm_Delta,	Nutri.Fat.FatPNIm_Delta,...
Nutri.Calor.CalorExport_AggCO,	Nutri.Prot.ProtExport_AggCO,	Nutri.Fat.FatExport_AggCO,...
Nutri.Calor.CalorImport_AggCO,	Nutri.Prot.ProtImport_AggCO,	Nutri.Fat.FatImport_AggCO,...
Nutri.Calor.CalorNetImp_AggCO,	Nutri.Prot.ProtNetImp_AggCO,	Nutri.Fat.FatNetImp_AggCO,...
Nutri.Calor.CalorPNIm_AggCO,	Nutri.Prot.ProtPNIm_AggCO,	Nutri.Fat.FatPNIm_AggCO,...
Nutri.Calor.CalorExport_ExpCO,	Nutri.Prot.ProtExport_ExpCO,	Nutri.Fat.FatExport_ExpCO,...
Nutri.Calor.CalorImport_ExpCO,	Nutri.Prot.ProtImport_ExpCO,	Nutri.Fat.FatImport_ExpCO,...
Nutri.Calor.CalorNetImp_ExpCO,	Nutri.Prot.ProtNetImp_ExpCO,	Nutri.Fat.FatNetImp_ExpCO,...
Nutri.Calor.CalorPNIm_ExpCO,	Nutri.Prot.ProtPNIm_ExpCO,	Nutri.Fat.FatPNIm_ExpCO,...
Nutri.Calor.CalorExport_DeltaCO,	Nutri.Prot.ProtExport_DeltaCO,	Nutri.Fat.FatExport_DeltaCO,...
Nutri.Calor.CalorImport_DeltaCO,	Nutri.Prot.ProtImport_DeltaCO,	Nutri.Fat.FatImport_DeltaCO,...
Nutri.Calor.CalorNetImp_DeltaCO,	Nutri.Prot.ProtNetImp_DeltaCO,	Nutri.Fat.FatNetImp_DeltaCO,...
Nutri.Calor.CalorPNIm_DeltaCO,      Nutri.Prot.ProtPNIm_DeltaCO,	Nutri.Fat.FatPNIm_DeltaCO,...
Nutri.Calc.CalcProd_Agg,	Nutri.Carb.CarbProd_Agg,	Nutri.Fe.FeProd_Agg,...
Nutri.Calc.CalcProd_Exp,	Nutri.Carb.CarbProd_Exp,	Nutri.Fe.FeProd_Exp,...
Nutri.Calc.CalcProd_Delta,	Nutri.Carb.CarbProd_Delta,	Nutri.Fe.FeProd_Delta,...
Nutri.Calc.CalcProd_AggCO,	Nutri.Carb.CarbProd_AggCO,	Nutri.Fe.FeProd_AggCO,...
Nutri.Calc.CalcProd_ExpCO,	Nutri.Carb.CarbProd_ExpCO,	Nutri.Fe.FeProd_ExpCO,...
Nutri.Calc.CalcProd_DeltaCO,	Nutri.Carb.CarbProd_DeltaCO,	Nutri.Fe.FeProd_DeltaCO,...
Nutri.Calc.CalcImTrdQnt_Agg,	Nutri.Carb.CarbImTrdQnt_Agg,	Nutri.Fe.FeImTrdQnt_Agg,...
Nutri.Calc.CalcImTrdQnt_Exp,	Nutri.Carb.CarbImTrdQnt_Exp,	Nutri.Fe.FeImTrdQnt_Exp,...
Nutri.Calc.CalcImTrdQnt_Delta,	Nutri.Carb.CarbImTrdQnt_Delta,	Nutri.Fe.FeImTrdQnt_Delta,...
Nutri.Calc.CalcExport_Agg,	Nutri.Carb.CarbExport_Agg,	Nutri.Fe.FeExport_Agg,...
Nutri.Calc.CalcImport_Agg,	Nutri.Carb.CarbImport_Agg,	Nutri.Fe.FeImport_Agg,...
Nutri.Calc.CalcNetImp_Agg,	Nutri.Carb.CarbNetImp_Agg,	Nutri.Fe.FeNetImp_Agg,...
Nutri.Calc.CalcPNIm_Agg,	Nutri.Carb.CarbPNIm_Agg,	Nutri.Fe.FePNIm_Agg,...
Nutri.Calc.CalcExport_Exp,	Nutri.Carb.CarbExport_Exp,	Nutri.Fe.FeExport_Exp,...
Nutri.Calc.CalcImport_Exp,	Nutri.Carb.CarbImport_Exp,	Nutri.Fe.FeImport_Exp,...
Nutri.Calc.CalcNetImp_Exp,	Nutri.Carb.CarbNetImp_Exp,	Nutri.Fe.FeNetImp_Exp,...
Nutri.Calc.CalcPNIm_Exp,	Nutri.Carb.CarbPNIm_Exp,	Nutri.Fe.FePNIm_Exp,...
Nutri.Calc.CalcExport_Delta,	Nutri.Carb.CarbExport_Delta,	Nutri.Fe.FeExport_Delta,...
Nutri.Calc.CalcImport_Delta,	Nutri.Carb.CarbImport_Delta,	Nutri.Fe.FeImport_Delta,...
Nutri.Calc.CalcNetImp_Delta,	Nutri.Carb.CarbNetImp_Delta,	Nutri.Fe.FeNetImp_Delta,...
Nutri.Calc.CalcPNIm_Delta,	Nutri.Carb.CarbPNIm_Delta,	Nutri.Fe.FePNIm_Delta,...
Nutri.Calc.CalcExport_AggCO,	Nutri.Carb.CarbExport_AggCO,	Nutri.Fe.FeExport_AggCO,...
Nutri.Calc.CalcImport_AggCO,	Nutri.Carb.CarbImport_AggCO,	Nutri.Fe.FeImport_AggCO,...
Nutri.Calc.CalcNetImp_AggCO,	Nutri.Carb.CarbNetImp_AggCO,	Nutri.Fe.FeNetImp_AggCO,...
Nutri.Calc.CalcPNIm_AggCO,	Nutri.Carb.CarbPNIm_AggCO,	Nutri.Fe.FePNIm_AggCO,...
Nutri.Calc.CalcExport_ExpCO,	Nutri.Carb.CarbExport_ExpCO,	Nutri.Fe.FeExport_ExpCO,...
Nutri.Calc.CalcImport_ExpCO,	Nutri.Carb.CarbImport_ExpCO,	Nutri.Fe.FeImport_ExpCO,...
Nutri.Calc.CalcNetImp_ExpCO,	Nutri.Carb.CarbNetImp_ExpCO,	Nutri.Fe.FeNetImp_ExpCO,...
Nutri.Calc.CalcPNIm_ExpCO,	Nutri.Carb.CarbPNIm_ExpCO,	Nutri.Fe.FePNIm_ExpCO,...
Nutri.Calc.CalcExport_DeltaCO,	Nutri.Carb.CarbExport_DeltaCO,	Nutri.Fe.FeExport_DeltaCO,...
Nutri.Calc.CalcImport_DeltaCO,	Nutri.Carb.CarbImport_DeltaCO,	Nutri.Fe.FeImport_DeltaCO,...
Nutri.Calc.CalcNetImp_DeltaCO,	Nutri.Carb.CarbNetImp_DeltaCO,	Nutri.Fe.FeNetImp_DeltaCO,...
Nutri.Calc.CalcPNIm_DeltaCO,	Nutri.Carb.CarbPNIm_DeltaCO,	Nutri.Fe.FePNIm_DeltaCO,...
Nutri.Fiber.FiberProd_Agg,	Nutri.Fol.FolProd_Agg,	Nutri.K.KProd_Agg,...
Nutri.Fiber.FiberProd_Exp,	Nutri.Fol.FolProd_Exp,	Nutri.K.KProd_Exp,...
Nutri.Fiber.FiberProd_Delta,	Nutri.Fol.FolProd_Delta,	Nutri.K.KProd_Delta,...
Nutri.Fiber.FiberProd_AggCO,	Nutri.Fol.FolProd_AggCO,	Nutri.K.KProd_AggCO,...
Nutri.Fiber.FiberProd_ExpCO,	Nutri.Fol.FolProd_ExpCO,	Nutri.K.KProd_ExpCO,...
Nutri.Fiber.FiberProd_DeltaCO,	Nutri.Fol.FolProd_DeltaCO,	Nutri.K.KProd_DeltaCO,...
Nutri.Fiber.FiberImTrdQnt_Agg,	Nutri.Fol.FolImTrdQnt_Agg,	Nutri.K.KImTrdQnt_Agg,...
Nutri.Fiber.FiberImTrdQnt_Exp,	Nutri.Fol.FolImTrdQnt_Exp,	Nutri.K.KImTrdQnt_Exp,...
Nutri.Fiber.FiberImTrdQnt_Delta,	Nutri.Fol.FolImTrdQnt_Delta,	Nutri.K.KImTrdQnt_Delta,...
Nutri.Fiber.FiberExport_Agg,	Nutri.Fol.FolExport_Agg,	Nutri.K.KExport_Agg,...
Nutri.Fiber.FiberImport_Agg,	Nutri.Fol.FolImport_Agg,	Nutri.K.KImport_Agg,...
Nutri.Fiber.FiberNetImp_Agg,	Nutri.Fol.FolNetImp_Agg,	Nutri.K.KNetImp_Agg,...
Nutri.Fiber.FiberPNIm_Agg,	Nutri.Fol.FolPNIm_Agg,	Nutri.K.KPNIm_Agg,...
Nutri.Fiber.FiberExport_Exp,	Nutri.Fol.FolExport_Exp,	Nutri.K.KExport_Exp,...
Nutri.Fiber.FiberImport_Exp,	Nutri.Fol.FolImport_Exp,	Nutri.K.KImport_Exp,...
Nutri.Fiber.FiberNetImp_Exp,	Nutri.Fol.FolNetImp_Exp,	Nutri.K.KNetImp_Exp,...
Nutri.Fiber.FiberPNIm_Exp,	Nutri.Fol.FolPNIm_Exp,	Nutri.K.KPNIm_Exp,...
Nutri.Fiber.FiberExport_Delta,	Nutri.Fol.FolExport_Delta,	Nutri.K.KExport_Delta,...
Nutri.Fiber.FiberImport_Delta,	Nutri.Fol.FolImport_Delta,	Nutri.K.KImport_Delta,...
Nutri.Fiber.FiberNetImp_Delta,	Nutri.Fol.FolNetImp_Delta,	Nutri.K.KNetImp_Delta,...
Nutri.Fiber.FiberPNIm_Delta,	Nutri.Fol.FolPNIm_Delta,	Nutri.K.KPNIm_Delta,...
Nutri.Fiber.FiberExport_AggCO,	Nutri.Fol.FolExport_AggCO,	Nutri.K.KExport_AggCO,...
Nutri.Fiber.FiberImport_AggCO,	Nutri.Fol.FolImport_AggCO,	Nutri.K.KImport_AggCO,...
Nutri.Fiber.FiberNetImp_AggCO,	Nutri.Fol.FolNetImp_AggCO,	Nutri.K.KNetImp_AggCO,...
Nutri.Fiber.FiberPNIm_AggCO,	Nutri.Fol.FolPNIm_AggCO,	Nutri.K.KPNIm_AggCO,...
Nutri.Fiber.FiberExport_ExpCO,	Nutri.Fol.FolExport_ExpCO,	Nutri.K.KExport_ExpCO,...
Nutri.Fiber.FiberImport_ExpCO,	Nutri.Fol.FolImport_ExpCO,	Nutri.K.KImport_ExpCO,...
Nutri.Fiber.FiberNetImp_ExpCO,	Nutri.Fol.FolNetImp_ExpCO,	Nutri.K.KNetImp_ExpCO,...
Nutri.Fiber.FiberPNIm_ExpCO,	Nutri.Fol.FolPNIm_ExpCO,	Nutri.K.KPNIm_ExpCO,...
Nutri.Fiber.FiberExport_DeltaCO,	Nutri.Fol.FolExport_DeltaCO,	Nutri.K.KExport_DeltaCO,...
Nutri.Fiber.FiberImport_DeltaCO,	Nutri.Fol.FolImport_DeltaCO,	Nutri.K.KImport_DeltaCO,...
Nutri.Fiber.FiberNetImp_DeltaCO,	Nutri.Fol.FolNetImp_DeltaCO,	Nutri.K.KNetImp_DeltaCO,...
Nutri.Fiber.FiberPNIm_DeltaCO,	Nutri.Fol.FolPNIm_DeltaCO,	Nutri.K.KPNIm_DeltaCO,...
Nutri.Mg.MgProd_Agg,	Nutri.Na.NaProd_Agg,	Nutri.Niac.NiacProd_Agg,...
Nutri.Mg.MgProd_Exp,	Nutri.Na.NaProd_Exp,	Nutri.Niac.NiacProd_Exp,...
Nutri.Mg.MgProd_Delta,	Nutri.Na.NaProd_Delta,	Nutri.Niac.NiacProd_Delta,...
Nutri.Mg.MgProd_AggCO,	Nutri.Na.NaProd_AggCO,	Nutri.Niac.NiacProd_AggCO,...
Nutri.Mg.MgProd_ExpCO,	Nutri.Na.NaProd_ExpCO,	Nutri.Niac.NiacProd_ExpCO,...
Nutri.Mg.MgProd_DeltaCO,	Nutri.Na.NaProd_DeltaCO,	Nutri.Niac.NiacProd_DeltaCO,...
Nutri.Mg.MgImTrdQnt_Agg,	Nutri.Na.NaImTrdQnt_Agg,	Nutri.Niac.NiacImTrdQnt_Agg,...
Nutri.Mg.MgImTrdQnt_Exp,	Nutri.Na.NaImTrdQnt_Exp,	Nutri.Niac.NiacImTrdQnt_Exp,...
Nutri.Mg.MgImTrdQnt_Delta,	Nutri.Na.NaImTrdQnt_Delta,	Nutri.Niac.NiacImTrdQnt_Delta,...
Nutri.Mg.MgExport_Agg,	Nutri.Na.NaExport_Agg,	Nutri.Niac.NiacExport_Agg,...
Nutri.Mg.MgImport_Agg,	Nutri.Na.NaImport_Agg,	Nutri.Niac.NiacImport_Agg,...
Nutri.Mg.MgNetImp_Agg,	Nutri.Na.NaNetImp_Agg,	Nutri.Niac.NiacNetImp_Agg,...
Nutri.Mg.MgPNIm_Agg,	Nutri.Na.NaPNIm_Agg,	Nutri.Niac.NiacPNIm_Agg,...
Nutri.Mg.MgExport_Exp,	Nutri.Na.NaExport_Exp,	Nutri.Niac.NiacExport_Exp,...
Nutri.Mg.MgImport_Exp,	Nutri.Na.NaImport_Exp,	Nutri.Niac.NiacImport_Exp,...
Nutri.Mg.MgNetImp_Exp,	Nutri.Na.NaNetImp_Exp,	Nutri.Niac.NiacNetImp_Exp,...
Nutri.Mg.MgPNIm_Exp,	Nutri.Na.NaPNIm_Exp,	Nutri.Niac.NiacPNIm_Exp,...
Nutri.Mg.MgExport_Delta,	Nutri.Na.NaExport_Delta,	Nutri.Niac.NiacExport_Delta,...
Nutri.Mg.MgImport_Delta,	Nutri.Na.NaImport_Delta,	Nutri.Niac.NiacImport_Delta,...
Nutri.Mg.MgNetImp_Delta,	Nutri.Na.NaNetImp_Delta,	Nutri.Niac.NiacNetImp_Delta,...
Nutri.Mg.MgPNIm_Delta,	Nutri.Na.NaPNIm_Delta,	Nutri.Niac.NiacPNIm_Delta,...
Nutri.Mg.MgExport_AggCO,	Nutri.Na.NaExport_AggCO,	Nutri.Niac.NiacExport_AggCO,...
Nutri.Mg.MgImport_AggCO,	Nutri.Na.NaImport_AggCO,	Nutri.Niac.NiacImport_AggCO,...
Nutri.Mg.MgNetImp_AggCO,	Nutri.Na.NaNetImp_AggCO,	Nutri.Niac.NiacNetImp_AggCO,...
Nutri.Mg.MgPNIm_AggCO,	Nutri.Na.NaPNIm_AggCO,	Nutri.Niac.NiacPNIm_AggCO,...
Nutri.Mg.MgExport_ExpCO,	Nutri.Na.NaExport_ExpCO,	Nutri.Niac.NiacExport_ExpCO,...
Nutri.Mg.MgImport_ExpCO,	Nutri.Na.NaImport_ExpCO,	Nutri.Niac.NiacImport_ExpCO,...
Nutri.Mg.MgNetImp_ExpCO,	Nutri.Na.NaNetImp_ExpCO,	Nutri.Niac.NiacNetImp_ExpCO,...
Nutri.Mg.MgPNIm_ExpCO,	Nutri.Na.NaPNIm_ExpCO,	Nutri.Niac.NiacPNIm_ExpCO,...
Nutri.Mg.MgExport_DeltaCO,	Nutri.Na.NaExport_DeltaCO,	Nutri.Niac.NiacExport_DeltaCO,...
Nutri.Mg.MgImport_DeltaCO,	Nutri.Na.NaImport_DeltaCO,	Nutri.Niac.NiacImport_DeltaCO,...
Nutri.Mg.MgNetImp_DeltaCO,	Nutri.Na.NaNetImp_DeltaCO,	Nutri.Niac.NiacNetImp_DeltaCO,...
Nutri.Mg.MgPNIm_DeltaCO,	Nutri.Na.NaPNIm_DeltaCO,	Nutri.Niac.NiacPNIm_DeltaCO,...
Nutri.Ribo.RiboProd_Agg,	Nutri.Sugar.SugarProd_Agg,	Nutri.VA.VAProd_Agg,...
Nutri.Ribo.RiboProd_Exp,	Nutri.Sugar.SugarProd_Exp,	Nutri.VA.VAProd_Exp,...
Nutri.Ribo.RiboProd_Delta,	Nutri.Sugar.SugarProd_Delta,	Nutri.VA.VAProd_Delta,...
Nutri.Ribo.RiboProd_AggCO,	Nutri.Sugar.SugarProd_AggCO,	Nutri.VA.VAProd_AggCO,...
Nutri.Ribo.RiboProd_ExpCO,	Nutri.Sugar.SugarProd_ExpCO,	Nutri.VA.VAProd_ExpCO,...
Nutri.Ribo.RiboProd_DeltaCO,	Nutri.Sugar.SugarProd_DeltaCO,	Nutri.VA.VAProd_DeltaCO,...
Nutri.Ribo.RiboImTrdQnt_Agg,	Nutri.Sugar.SugarImTrdQnt_Agg,	Nutri.VA.VAImTrdQnt_Agg,...
Nutri.Ribo.RiboImTrdQnt_Exp,	Nutri.Sugar.SugarImTrdQnt_Exp,	Nutri.VA.VAImTrdQnt_Exp,...
Nutri.Ribo.RiboImTrdQnt_Delta,	Nutri.Sugar.SugarImTrdQnt_Delta,	Nutri.VA.VAImTrdQnt_Delta,...
Nutri.Ribo.RiboExport_Agg,	Nutri.Sugar.SugarExport_Agg,	Nutri.VA.VAExport_Agg,...
Nutri.Ribo.RiboImport_Agg,	Nutri.Sugar.SugarImport_Agg,	Nutri.VA.VAImport_Agg,...
Nutri.Ribo.RiboNetImp_Agg,	Nutri.Sugar.SugarNetImp_Agg,	Nutri.VA.VANetImp_Agg,...
Nutri.Ribo.RiboPNIm_Agg,	Nutri.Sugar.SugarPNIm_Agg,	Nutri.VA.VAPNIm_Agg,...
Nutri.Ribo.RiboExport_Exp,	Nutri.Sugar.SugarExport_Exp,	Nutri.VA.VAExport_Exp,...
Nutri.Ribo.RiboImport_Exp,	Nutri.Sugar.SugarImport_Exp,	Nutri.VA.VAImport_Exp,...
Nutri.Ribo.RiboNetImp_Exp,	Nutri.Sugar.SugarNetImp_Exp,	Nutri.VA.VANetImp_Exp,...
Nutri.Ribo.RiboPNIm_Exp,	Nutri.Sugar.SugarPNIm_Exp,	Nutri.VA.VAPNIm_Exp,...
Nutri.Ribo.RiboExport_Delta,	Nutri.Sugar.SugarExport_Delta,	Nutri.VA.VAExport_Delta,...
Nutri.Ribo.RiboImport_Delta,	Nutri.Sugar.SugarImport_Delta,	Nutri.VA.VAImport_Delta,...
Nutri.Ribo.RiboNetImp_Delta,	Nutri.Sugar.SugarNetImp_Delta,	Nutri.VA.VANetImp_Delta,...
Nutri.Ribo.RiboPNIm_Delta,	Nutri.Sugar.SugarPNIm_Delta,	Nutri.VA.VAPNIm_Delta,...
Nutri.Ribo.RiboExport_AggCO,	Nutri.Sugar.SugarExport_AggCO,	Nutri.VA.VAExport_AggCO,...
Nutri.Ribo.RiboImport_AggCO,	Nutri.Sugar.SugarImport_AggCO,	Nutri.VA.VAImport_AggCO,...
Nutri.Ribo.RiboNetImp_AggCO,	Nutri.Sugar.SugarNetImp_AggCO,	Nutri.VA.VANetImp_AggCO,...
Nutri.Ribo.RiboPNIm_AggCO,	Nutri.Sugar.SugarPNIm_AggCO,	Nutri.VA.VAPNIm_AggCO,...
Nutri.Ribo.RiboExport_ExpCO,	Nutri.Sugar.SugarExport_ExpCO,	Nutri.VA.VAExport_ExpCO,...
Nutri.Ribo.RiboImport_ExpCO,	Nutri.Sugar.SugarImport_ExpCO,	Nutri.VA.VAImport_ExpCO,...
Nutri.Ribo.RiboNetImp_ExpCO,	Nutri.Sugar.SugarNetImp_ExpCO,	Nutri.VA.VANetImp_ExpCO,...
Nutri.Ribo.RiboPNIm_ExpCO,	Nutri.Sugar.SugarPNIm_ExpCO,	Nutri.VA.VAPNIm_ExpCO,...
Nutri.Ribo.RiboExport_DeltaCO,	Nutri.Sugar.SugarExport_DeltaCO,	Nutri.VA.VAExport_DeltaCO,...
Nutri.Ribo.RiboImport_DeltaCO,	Nutri.Sugar.SugarImport_DeltaCO,	Nutri.VA.VAImport_DeltaCO,...
Nutri.Ribo.RiboNetImp_DeltaCO,	Nutri.Sugar.SugarNetImp_DeltaCO,	Nutri.VA.VANetImp_DeltaCO,...
Nutri.Ribo.RiboPNIm_DeltaCO,	Nutri.Sugar.SugarPNIm_DeltaCO,	Nutri.VA.VAPNIm_DeltaCO,...
Nutri.VB12.VB12Prod_Agg,	Nutri.VB6.VB6Prod_Agg,	Nutri.VC.VCProd_Agg,...
Nutri.VB12.VB12Prod_Exp,	Nutri.VB6.VB6Prod_Exp,	Nutri.VC.VCProd_Exp,...
Nutri.VB12.VB12Prod_Delta,	Nutri.VB6.VB6Prod_Delta,	Nutri.VC.VCProd_Delta,...
Nutri.VB12.VB12Prod_AggCO,	Nutri.VB6.VB6Prod_AggCO,	Nutri.VC.VCProd_AggCO,...
Nutri.VB12.VB12Prod_ExpCO,	Nutri.VB6.VB6Prod_ExpCO,	Nutri.VC.VCProd_ExpCO,...
Nutri.VB12.VB12Prod_DeltaCO,	Nutri.VB6.VB6Prod_DeltaCO,	Nutri.VC.VCProd_DeltaCO,...
Nutri.VB12.VB12ImTrdQnt_Agg,	Nutri.VB6.VB6ImTrdQnt_Agg,	Nutri.VC.VCImTrdQnt_Agg,...
Nutri.VB12.VB12ImTrdQnt_Exp,	Nutri.VB6.VB6ImTrdQnt_Exp,	Nutri.VC.VCImTrdQnt_Exp,...
Nutri.VB12.VB12ImTrdQnt_Delta,	Nutri.VB6.VB6ImTrdQnt_Delta,	Nutri.VC.VCImTrdQnt_Delta,...
Nutri.VB12.VB12Export_Agg,	Nutri.VB6.VB6Export_Agg,	Nutri.VC.VCExport_Agg,...
Nutri.VB12.VB12Import_Agg,	Nutri.VB6.VB6Import_Agg,	Nutri.VC.VCImport_Agg,...
Nutri.VB12.VB12NetImp_Agg,	Nutri.VB6.VB6NetImp_Agg,	Nutri.VC.VCNetImp_Agg,...
Nutri.VB12.VB12PNIm_Agg,	Nutri.VB6.VB6PNIm_Agg,	Nutri.VC.VCPNIm_Agg,...
Nutri.VB12.VB12Export_Exp,	Nutri.VB6.VB6Export_Exp,	Nutri.VC.VCExport_Exp,...
Nutri.VB12.VB12Import_Exp,	Nutri.VB6.VB6Import_Exp,	Nutri.VC.VCImport_Exp,...
Nutri.VB12.VB12NetImp_Exp,	Nutri.VB6.VB6NetImp_Exp,	Nutri.VC.VCNetImp_Exp,...
Nutri.VB12.VB12PNIm_Exp,	Nutri.VB6.VB6PNIm_Exp,	Nutri.VC.VCPNIm_Exp,...
Nutri.VB12.VB12Export_Delta,	Nutri.VB6.VB6Export_Delta,	Nutri.VC.VCExport_Delta,...
Nutri.VB12.VB12Import_Delta,	Nutri.VB6.VB6Import_Delta,	Nutri.VC.VCImport_Delta,...
Nutri.VB12.VB12NetImp_Delta,	Nutri.VB6.VB6NetImp_Delta,	Nutri.VC.VCNetImp_Delta,...
Nutri.VB12.VB12PNIm_Delta,	Nutri.VB6.VB6PNIm_Delta,	Nutri.VC.VCPNIm_Delta,...
Nutri.VB12.VB12Export_AggCO,	Nutri.VB6.VB6Export_AggCO,	Nutri.VC.VCExport_AggCO,...
Nutri.VB12.VB12Import_AggCO,	Nutri.VB6.VB6Import_AggCO,	Nutri.VC.VCImport_AggCO,...
Nutri.VB12.VB12NetImp_AggCO,	Nutri.VB6.VB6NetImp_AggCO,	Nutri.VC.VCNetImp_AggCO,...
Nutri.VB12.VB12PNIm_AggCO,	Nutri.VB6.VB6PNIm_AggCO,	Nutri.VC.VCPNIm_AggCO,...
Nutri.VB12.VB12Export_ExpCO,	Nutri.VB6.VB6Export_ExpCO,	Nutri.VC.VCExport_ExpCO,...
Nutri.VB12.VB12Import_ExpCO,	Nutri.VB6.VB6Import_ExpCO,	Nutri.VC.VCImport_ExpCO,...
Nutri.VB12.VB12NetImp_ExpCO,	Nutri.VB6.VB6NetImp_ExpCO,	Nutri.VC.VCNetImp_ExpCO,...
Nutri.VB12.VB12PNIm_ExpCO,	Nutri.VB6.VB6PNIm_ExpCO,	Nutri.VC.VCPNIm_ExpCO,...
Nutri.VB12.VB12Export_DeltaCO,	Nutri.VB6.VB6Export_DeltaCO,	Nutri.VC.VCExport_DeltaCO,...
Nutri.VB12.VB12Import_DeltaCO,	Nutri.VB6.VB6Import_DeltaCO,	Nutri.VC.VCImport_DeltaCO,...
Nutri.VB12.VB12NetImp_DeltaCO,	Nutri.VB6.VB6NetImp_DeltaCO,	Nutri.VC.VCNetImp_DeltaCO,...
Nutri.VB12.VB12PNIm_DeltaCO,	Nutri.VB6.VB6PNIm_DeltaCO,	Nutri.VC.VCPNIm_DeltaCO,...
Nutri.VD.VDProd_Agg,	Nutri.VE.VEProd_Agg,	Nutri.Zn.ZnProd_Agg,...
Nutri.VD.VDProd_Exp,	Nutri.VE.VEProd_Exp,	Nutri.Zn.ZnProd_Exp,...
Nutri.VD.VDProd_Delta,	Nutri.VE.VEProd_Delta,	Nutri.Zn.ZnProd_Delta,...
Nutri.VD.VDProd_AggCO,	Nutri.VE.VEProd_AggCO,	Nutri.Zn.ZnProd_AggCO,...
Nutri.VD.VDProd_ExpCO,	Nutri.VE.VEProd_ExpCO,	Nutri.Zn.ZnProd_ExpCO,...
Nutri.VD.VDProd_DeltaCO,	Nutri.VE.VEProd_DeltaCO,	Nutri.Zn.ZnProd_DeltaCO,...
Nutri.VD.VDImTrdQnt_Agg,	Nutri.VE.VEImTrdQnt_Agg,	Nutri.Zn.ZnImTrdQnt_Agg,...
Nutri.VD.VDImTrdQnt_Exp,	Nutri.VE.VEImTrdQnt_Exp,	Nutri.Zn.ZnImTrdQnt_Exp,...
Nutri.VD.VDImTrdQnt_Delta,	Nutri.VE.VEImTrdQnt_Delta,	Nutri.Zn.ZnImTrdQnt_Delta,...
Nutri.VD.VDExport_Agg,	Nutri.VE.VEExport_Agg,	Nutri.Zn.ZnExport_Agg,...
Nutri.VD.VDImport_Agg,	Nutri.VE.VEImport_Agg,	Nutri.Zn.ZnImport_Agg,...
Nutri.VD.VDNetImp_Agg,	Nutri.VE.VENetImp_Agg,	Nutri.Zn.ZnNetImp_Agg,...
Nutri.VD.VDPNIm_Agg,	Nutri.VE.VEPNIm_Agg,	Nutri.Zn.ZnPNIm_Agg,...
Nutri.VD.VDExport_Exp,	Nutri.VE.VEExport_Exp,	Nutri.Zn.ZnExport_Exp,...
Nutri.VD.VDImport_Exp,	Nutri.VE.VEImport_Exp,	Nutri.Zn.ZnImport_Exp,...
Nutri.VD.VDNetImp_Exp,	Nutri.VE.VENetImp_Exp,	Nutri.Zn.ZnNetImp_Exp,...
Nutri.VD.VDPNIm_Exp,	Nutri.VE.VEPNIm_Exp,	Nutri.Zn.ZnPNIm_Exp,...
Nutri.VD.VDExport_Delta,	Nutri.VE.VEExport_Delta,	Nutri.Zn.ZnExport_Delta,...
Nutri.VD.VDImport_Delta,	Nutri.VE.VEImport_Delta,	Nutri.Zn.ZnImport_Delta,...
Nutri.VD.VDNetImp_Delta,	Nutri.VE.VENetImp_Delta,	Nutri.Zn.ZnNetImp_Delta,...
Nutri.VD.VDPNIm_Delta,	Nutri.VE.VEPNIm_Delta,	Nutri.Zn.ZnPNIm_Delta,...
Nutri.VD.VDExport_AggCO,	Nutri.VE.VEExport_AggCO,	Nutri.Zn.ZnExport_AggCO,...
Nutri.VD.VDImport_AggCO,	Nutri.VE.VEImport_AggCO,	Nutri.Zn.ZnImport_AggCO,...
Nutri.VD.VDNetImp_AggCO,	Nutri.VE.VENetImp_AggCO,	Nutri.Zn.ZnNetImp_AggCO,...
Nutri.VD.VDPNIm_AggCO,	Nutri.VE.VEPNIm_AggCO,	Nutri.Zn.ZnPNIm_AggCO,...
Nutri.VD.VDExport_ExpCO,	Nutri.VE.VEExport_ExpCO,	Nutri.Zn.ZnExport_ExpCO,...
Nutri.VD.VDImport_ExpCO,	Nutri.VE.VEImport_ExpCO,	Nutri.Zn.ZnImport_ExpCO,...
Nutri.VD.VDNetImp_ExpCO,	Nutri.VE.VENetImp_ExpCO,	Nutri.Zn.ZnNetImp_ExpCO,...
Nutri.VD.VDPNIm_ExpCO,	Nutri.VE.VEPNIm_ExpCO,	Nutri.Zn.ZnPNIm_ExpCO,...
Nutri.VD.VDExport_DeltaCO,	Nutri.VE.VEExport_DeltaCO,	Nutri.Zn.ZnExport_DeltaCO,...
Nutri.VD.VDImport_DeltaCO,	Nutri.VE.VEImport_DeltaCO,	Nutri.Zn.ZnImport_DeltaCO,...
Nutri.VD.VDNetImp_DeltaCO,	Nutri.VE.VENetImp_DeltaCO,	Nutri.Zn.ZnNetImp_DeltaCO,...
Nutri.VD.VDPNIm_DeltaCO,	Nutri.VE.VEPNIm_DeltaCO,	Nutri.Zn.ZnPNIm_DeltaCO,...
Nutri.Thia.ThiaProd_Agg,    Nutri.Thia.ThiaProd_Exp,     Nutri.Thia.ThiaProd_Delta,   ...
Nutri.Thia.ThiaProd_AggCO,  Nutri.Thia.ThiaProd_ExpCO,    Nutri.Thia.ThiaProd_DeltaCO,  ... 
Nutri.Thia.ThiaImTrdQnt_Agg,Nutri.Thia.ThiaImTrdQnt_Exp,   Nutri.Thia.ThiaImTrdQnt_Delta,...
Nutri.Thia.ThiaExport_Agg,  Nutri.Thia.ThiaImport_Agg,     Nutri.Thia.ThiaNetImp_Agg,    ...
Nutri.Thia.ThiaPNIm_Agg,    Nutri.Thia.ThiaExport_Exp,     Nutri.Thia.ThiaImport_Exp,    ...
Nutri.Thia.ThiaNetImp_Exp,  Nutri.Thia.hiaPNIm_Exp,        Nutri.Thia.ThiaExport_Delta,  ...
Nutri.Thia.ThiaImport_Delta,Nutri.Thia.ThiaNetImp_Delta,   Nutri.Thia.ThiaPNIm_Delta,    ...
Nutri.Thia.ThiaExport_AggCO,Nutri.Thia.ThiaImport_AggCO,   Nutri.Thia.ThiaNetImp_AggCO,  ...
Nutri.Thia.ThiaPNIm_AggCO,  Nutri.Thia.ThiaExport_ExpCO,   Nutri.Thia.ThiaImport_ExpCO,  ...
Nutri.Thia.ThiaNetImp_ExpCO,Nutri.Thia.ThiaPNIm_ExpCO,     Nutri.Thia.ThiaExport_DeltaCO,...
Nutri.Thia.ThiaImport_DeltaCO, Nutri.Thia.ThiaNetImp_DeltaCO, Nutri.Thia.ThiaPNIm_DeltaCO,...
Nutri.Calor.CalorProd_AggCO_POPD,	Nutri.Prot.ProtProd_AggCO_POPD,	Nutri.Fat.FatProd_AggCO_POPD,...	
Nutri.Calc.CalcProd_AggCO_POPD,	Nutri.Carb.CarbProd_AggCO_POPD,	Nutri.Fe.FeProd_AggCO_POPD,...	
Nutri.Fiber.FiberProd_AggCO_POPD,	Nutri.Fol.FolProd_AggCO_POPD,	Nutri.K.KProd_AggCO_POPD,...	
Nutri.Mg.MgProd_AggCO_POPD,	Nutri.Na.NaProd_AggCO_POPD,	Nutri.Niac.NiacProd_AggCO_POPD,...	
Nutri.Ribo.RiboProd_AggCO_POPD,	Nutri.Sugar.SugarProd_AggCO_POPD,	Nutri.Thia.ThiaProd_AggCO_POPD,...	
Nutri.VA.VAProd_AggCO_POPD,	Nutri.VB12.VB12Prod_AggCO_POPD,	Nutri.VB6.VB6Prod_AggCO_POPD,...	
Nutri.VC.VCProd_AggCO_POPD,	Nutri.VD.VDProd_AggCO_POPD,	Nutri.VE.VEProd_AggCO_POPD,	Nutri.Zn.ZnProd_AggCO_POPD,...
Nutri.Calor.CalorPNIm_AggCO_POPD,	Nutri.Prot.ProtPNIm_AggCO_POPD,	Nutri.Fat.FatPNIm_AggCO_POPD,...	
Nutri.Calc.CalcPNIm_AggCO_POPD,	Nutri.Carb.CarbPNIm_AggCO_POPD,	Nutri.Fe.FePNIm_AggCO_POPD,...	
Nutri.Fiber.FiberPNIm_AggCO_POPD,	Nutri.Fol.FolPNIm_AggCO_POPD,	Nutri.K.KPNIm_AggCO_POPD,...	
Nutri.Mg.MgPNIm_AggCO_POPD,	Nutri.Na.NaPNIm_AggCO_POPD,	Nutri.Niac.NiacPNIm_AggCO_POPD,...	
Nutri.Ribo.RiboPNIm_AggCO_POPD,	Nutri.Sugar.SugarPNIm_AggCO_POPD,	Nutri.Thia.ThiaPNIm_AggCO_POPD,...	
Nutri.VA.VAPNIm_AggCO_POPD,	Nutri.VB12.VB12PNIm_AggCO_POPD,	Nutri.VB6.VB6PNIm_AggCO_POPD,...	
Nutri.VC.VCPNIm_AggCO_POPD,	Nutri.VD.VDPNIm_AggCO_POPD,	Nutri.VE.VEPNIm_AggCO_POPD,	Nutri.Zn.ZnPNIm_AggCO_POPD,...
Nutri.Calor.CalorProd_ExpCO_POPD,	Nutri.Prot.ProtProd_ExpCO_POPD,	Nutri.Fat.FatProd_ExpCO_POPD,...	
Nutri.Calc.CalcProd_ExpCO_POPD,	Nutri.Carb.CarbProd_ExpCO_POPD,	Nutri.Fe.FeProd_ExpCO_POPD,...	
Nutri.Fiber.FiberProd_ExpCO_POPD,	Nutri.Fol.FolProd_ExpCO_POPD,	Nutri.K.KProd_ExpCO_POPD,...	
Nutri.Mg.MgProd_ExpCO_POPD,	Nutri.Na.NaProd_ExpCO_POPD,	Nutri.Niac.NiacProd_ExpCO_POPD,...	
Nutri.Ribo.RiboProd_ExpCO_POPD,	Nutri.Sugar.SugarProd_ExpCO_POPD,	Nutri.Thia.ThiaProd_ExpCO_POPD,...	
Nutri.VA.VAProd_ExpCO_POPD,	Nutri.VB12.VB12Prod_ExpCO_POPD,	Nutri.VB6.VB6Prod_ExpCO_POPD,...	
Nutri.VC.VCProd_ExpCO_POPD,	Nutri.VD.VDProd_ExpCO_POPD,	Nutri.VE.VEProd_ExpCO_POPD,	Nutri.Zn.ZnProd_ExpCO_POPD,...
Nutri.Calor.CalorPNIm_ExpCO_POPD,	Nutri.Prot.ProtPNIm_ExpCO_POPD,	Nutri.Fat.FatPNIm_ExpCO_POPD,...	
Nutri.Calc.CalcPNIm_ExpCO_POPD,	Nutri.Carb.CarbPNIm_ExpCO_POPD,	Nutri.Fe.FePNIm_ExpCO_POPD,...	
Nutri.Fiber.FiberPNIm_ExpCO_POPD,	Nutri.Fol.FolPNIm_ExpCO_POPD,	Nutri.K.KPNIm_ExpCO_POPD,...	
Nutri.Mg.MgPNIm_ExpCO_POPD,	Nutri.Na.NaPNIm_ExpCO_POPD,	Nutri.Niac.NiacPNIm_ExpCO_POPD,...	
Nutri.Ribo.RiboPNIm_ExpCO_POPD,	Nutri.Sugar.SugarPNIm_ExpCO_POPD,	Nutri.Thia.ThiaPNIm_ExpCO_POPD,...	
Nutri.VA.VAPNIm_ExpCO_POPD,	Nutri.VB12.VB12PNIm_ExpCO_POPD,	Nutri.VB6.VB6PNIm_ExpCO_POPD,...	
Nutri.VC.VCPNIm_ExpCO_POPD,	Nutri.VD.VDPNIm_ExpCO_POPD,	Nutri.VE.VEPNIm_ExpCO_POPD,	Nutri.Zn.ZnPNIm_ExpCO_POPD,...
Nutri.Calor.CalorProd_PopRatio,	Nutri.Prot.ProtProd_PopRatio,	Nutri.Fat.FatProd_PopRatio,...	
Nutri.Calc.CalcProd_PopRatio,	Nutri.Carb.CarbProd_PopRatio,	Nutri.Fe.FeProd_PopRatio,...	
Nutri.Fiber.FiberProd_PopRatio,	Nutri.Fol.FolProd_PopRatio,	Nutri.K.KProd_PopRatio,...	
Nutri.Mg.MgProd_PopRatio,	Nutri.Na.NaProd_PopRatio,	Nutri.Niac.NiacProd_PopRatio,...	
Nutri.Ribo.RiboProd_PopRatio,	Nutri.Sugar.SugarProd_PopRatio,	Nutri.Thia.ThiaProd_PopRatio,...	
Nutri.VA.VAProd_PopRatio,	Nutri.VB12.VB12Prod_PopRatio,	Nutri.VB6.VB6Prod_PopRatio,...	
Nutri.VC.VCProd_PopRatio,	Nutri.VD.VDProd_PopRatio,	Nutri.VE.VEProd_PopRatio,	Nutri.Zn.ZnProd_PopRatio,...
Nutri.Calor.CalorPNIm_PopRatio,	Nutri.Prot.ProtPNIm_PopRatio,	Nutri.Fat.FatPNIm_PopRatio,...	
Nutri.Calc.CalcPNIm_PopRatio,	Nutri.Carb.CarbPNIm_PopRatio,	Nutri.Fe.FePNIm_PopRatio,...	
Nutri.Fiber.FiberPNIm_PopRatio,	Nutri.Fol.FolPNIm_PopRatio,	Nutri.K.KPNIm_PopRatio,...	
Nutri.Mg.MgPNIm_PopRatio,	Nutri.Na.NaPNIm_PopRatio,	Nutri.Niac.NiacPNIm_PopRatio,...	
Nutri.Ribo.RiboPNIm_PopRatio,	Nutri.Sugar.SugarPNIm_PopRatio,	Nutri.Thia.ThiaPNIm_PopRatio,...	
Nutri.VA.VAPNIm_PopRatio,	Nutri.VB12.VB12PNIm_PopRatio,	Nutri.VB6.VB6PNIm_PopRatio,...	
Nutri.VC.VCPNIm_PopRatio,	Nutri.VD.VDPNIm_PopRatio,	Nutri.VE.VEPNIm_PopRatio,	Nutri.Zn.ZnPNIm_PopRatio,...
Nutri.Calor.CalorProd_PopRatioExp,	Nutri.Prot.ProtProd_PopRatioExp,	Nutri.Fat.FatProd_PopRatioExp,...	
Nutri.Calc.CalcProd_PopRatioExp,	Nutri.Carb.CarbProd_PopRatioExp,	Nutri.Fe.FeProd_PopRatioExp,...	
Nutri.Fiber.FiberProd_PopRatioExp,	Nutri.Fol.FolProd_PopRatioExp,	Nutri.K.KProd_PopRatioExp,...	
Nutri.Mg.MgProd_PopRatioExp,	Nutri.Na.NaProd_PopRatioExp,	Nutri.Niac.NiacProd_PopRatioExp,...	
Nutri.Ribo.RiboProd_PopRatioExp,	Nutri.Sugar.SugarProd_PopRatioExp,	Nutri.Thia.ThiaProd_PopRatioExp,...	
Nutri.VA.VAProd_PopRatioExp,	Nutri.VB12.VB12Prod_PopRatioExp,	Nutri.VB6.VB6Prod_PopRatioExp,...	
Nutri.VC.VCProd_PopRatioExp,	Nutri.VD.VDProd_PopRatioExp,	Nutri.VE.VEProd_PopRatioExp,	Nutri.Zn.ZnProd_PopRatioExp,...
Nutri.Calor.CalorPNIm_PopRatioExp,	Nutri.Prot.ProtPNIm_PopRatioExp,	Nutri.Fat.FatPNIm_PopRatioExp,...	
Nutri.Calc.CalcPNIm_PopRatioExp,	Nutri.Carb.CarbPNIm_PopRatioExp,	Nutri.Fe.FePNIm_PopRatioExp,...	
Nutri.Fiber.FiberPNIm_PopRatioExp,	Nutri.Fol.FolPNIm_PopRatioExp,	Nutri.K.KPNIm_PopRatioExp,...	
Nutri.Mg.MgPNIm_PopRatioExp,	Nutri.Na.NaPNIm_PopRatioExp,	Nutri.Niac.NiacPNIm_PopRatioExp,...	
Nutri.Ribo.RiboPNIm_PopRatioExp,	Nutri.Sugar.SugarPNIm_PopRatioExp,	Nutri.Thia.ThiaPNIm_PopRatioExp,...	
Nutri.VA.VAPNIm_PopRatioExp,	Nutri.VB12.VB12PNIm_PopRatioExp,	Nutri.VB6.VB6PNIm_PopRatioExp,...	
Nutri.VC.VCPNIm_PopRatioExp,	Nutri.VD.VDPNIm_PopRatioExp,	Nutri.VE.VEPNIm_PopRatioExp,	Nutri.Zn.ZnPNIm_PopRatioExp,...
Nutri.Calor.CalorCont_Agg,	Nutri.Prot.ProtCont_Agg,	Nutri.Fat.FatCont_Agg,...	
Nutri.Calc.CalcCont_Agg,	Nutri.Carb.CarbCont_Agg,	Nutri.Fe.FeCont_Agg,...	
Nutri.Fiber.FiberCont_Agg,	Nutri.Fol.FolCont_Agg,	Nutri.K.KCont_Agg,...	
Nutri.Mg.MgCont_Agg,	Nutri.Na.NaCont_Agg,	Nutri.Niac.NiacCont_Agg,...	
Nutri.Ribo.RiboCont_Agg,	Nutri.Sugar.SugarCont_Agg,	Nutri.Thia.ThiaCont_Agg,...	
Nutri.VA.VACont_Agg,	Nutri.VB12.VB12Cont_Agg,	Nutri.VB6.VB6Cont_Agg,...	
Nutri.VC.VCCont_Agg,	Nutri.VD.VDCont_Agg,	Nutri.VE.VECont_Agg,	Nutri.Zn.ZnCont_Agg,...
Soc.TopS.Area_Rank,          Soc.TopS.Ind_area,           Soc.TopS.Area_Top2,           Soc.TopS.Area_Top3,...
Soc.TopS.Area_Rank_Exp,      Soc.TopS.Ind_area_Exp,       Soc.TopS.Area_Top2_Exp,       Soc.TopS.Area_Top3_Exp,...
Soc.TopS.Area_Top2_DeltaCO,  Soc.TopS.Area_Top3_DeltaCO,  Soc.TopS.Ind_crop2,           Soc.TopS.Ind_crop3]...
    = SAM_CMT(harvst_new,prod_new,price_new,trade_new,harvst_aez_new,prod_aez_new,CR_MAP,CN_MAP,CR_ARY,CN_ARY,CR_IND,baseyr,dir,dir_s);
        
%% Read in the decomposition results

clear fname;
DECOMP_FILE = 'TariffDecomp_fz_all.csv'; %%% Decomposition in harvested area % changes
fname = [dir 'Application' dir_s 'Inputs' dir_s DECOMP_FILE];
fid = fopen(fname)

fmt = ' %s %s %f %f %f %f %f %f';                         %***
hd_no = 8;                                                %***

Raw_header = textscan(fid, '%s', hd_no, 'delimiter', ',');
Raw_Data = textscan(fid, fmt, 'delimiter',',');
fclose(fid);

CR_Raw = string(Raw_Data{1,1});
trf_Raw = string(Raw_Data{1,2});
AreaDecomp_Raw = cell2mat(Raw_Data(3:8));

%%% Organize decomposition data
trf = ["Wheat Tariff","Sorghum Tariff", "Corn Tariff", "Soybean Tariff", "Beef Tariff"];
CR_ARYCR = ["Paddy Rice", "Wheat","Sorghum", "Corn","Soybeans",...
            "Palm Fruit","Rapeseed","OthOilseeds","SugarCrop","OthAgri"];
        
Crop_Label = {{'Paddy', 'Rice'}, 'Wheat','Sorghum', 'Corn','Soybeans',...
            {'Palm', 'Fruit'},'Rapeseed',{'Oth','Oilseeds'},{'Sugar','Crop'},"OthAgri"};

AreaDecomp_PDelta(1:co_dim,1:length(CR_ARYCR),1:length(trf)) = nan; %PDelta = % changes
for cr = 1:1:length(CR_ARYCR)  
    for tf = 1:1:length(trf)
        clear ind;
        ind = find((CR_Raw == CR_ARYCR(cr)) & (trf_Raw == trf(tf)));
        AreaDecomp_PDelta(:,cr,tf) = transpose(AreaDecomp_Raw(ind,:));
    end
end

AreaDecomp_Delta(1:co_dim,1:length(CR_ARYCR),1:length(trf)) = nan;
for tf = 1:1:length(trf)
    AreaDecomp_Delta(:,:,tf) = AreaDecomp_Agg(:,:,tf).*AreaH_FAO_Agg(:,1:length(CR_ARYCR),yr_base)./100;
end

%%% Plot the decomposition results

AreaDecomp_Delta_pos = AreaDecomp_Delta;
AreaDecomp_Delta_pos(AreaDecomp_Delta_pos<0) = 0;
AreaDecomp_Delta_neg = AreaDecomp_Delta;
AreaDecomp_Delta_neg(AreaDecomp_Delta_neg>0) = 0;

c = ...
   [     0    0.4470    0.7410;
    0.8500    0.3250    0.0980;
    0.4940    0.1840    0.5560;
    0.9290    0.6940    0.1250;
    0.4660    0.6740    0.1880;
    0.3010    0.7450    0.9330;
    0.6350    0.0780    0.1840;
    0.6816    0.7812    0.9324;
    0.8387    0.3042    0.6900;
    0.4600    0.7597    0.9590;
    0.5477    0.3999    0.0376];

%{
for co = 1:1:6
    subplot(3,2,co)
    b_p = bar(squeeze(AreaDecomp_Delta_pos(co,:,:)),'stacked','EdgeColor','none');
    hold on
    b_n = bar(squeeze(AreaDecomp_Delta_neg(co,:,:)),'stacked','EdgeColor','none'); 
    hold off
    for k=1:length(trf) 
        set(b_p(1,k),'facecolor',c(k,:))
        set(b_n(1,k),'facecolor',c(k,:))
    end
end
%}
figure('units','normalized','outerposition',[0 0 1 1]);
[ha, pos] = tight_subplot(3,2,[0 0.05],[.1 .05],[.04 .1]) 
for co = 1:6
    axes(ha(co));
    b_p = bar(squeeze(AreaDecomp_Delta_pos(co,:,:)),'stacked','EdgeColor','none');
    hold on;
    b_n = bar(squeeze(AreaDecomp_Delta_neg(co,:,:)),'stacked','EdgeColor','none'); 
    hold off
    for k=1:length(trf) 
        set(b_p(1,k),'facecolor',c(k,:))
        set(b_n(1,k),'facecolor',c(k,:))
    end
    yl(co,:) = get(gca,'ylim');
    box off;
    ylabel(CN_Label(co))
    if (co == 5) | (co ==6)
        yTick = get(gca,'ytick');
        set(gca,'xticklabel',[])
        xTick = get(gca,'xtick');
        for k = 1:length(CR_ARYCR)
            text(xTick(k),-40000-0.05*(25000+40000),Crop_Label{k},'HorizontalAlignment','center')
        end
    end
end  
%set(ha(5:6),'XTickLabel',Crop_Label);    

yTick = get(gca,'ytick');
set(gca,'xticklabel',[])
xTick = get(gca,'xtick');

%ylim(ha,min(yl(:,1)),max(yl(:,1)));
set(ha,'ylim',[-40000 25000])
%set(ha,'YTickLabel','')
hL = legend(trf,'Location','north')

% Programatically move the Legend
newPosition = [0.94 0.849 0.01 0.1];
newUnits = 'normalized';
set(hL,'Position', newPosition,'Units', newUnits);

%% Result Presentation

CN_Label =  ["Global","USA","EU27","BRAZIL","CHINA","SoAmer","OTHER"];
CR_Label = ["Paddy Rice", "Wheat","Sorghum", "Corn","Soybeans",...
            "Palm Fruit","Rapeseed","Oth Oilseeds","Sugar Crop","OthAgri"];
CR_Label1 = ["Paddy Rice", "Wheat","Sorghum", "Oth CoarseGrain","Soybeans",...
            "Palm Fruit","Rapeseed","Oth Oilseeds","Sugar Crop","OthAgri","PastureCrop"];       

%                   or [gap_h gap_w] for different gaps in height and width 
%        marg_h  margins in height in normalized units (0...1)
%                   or [lower upper] for different lower and upper margins 
%        marg_w  margins in width in normalized units (0...1)
%                   or [left right] for different left and right margins         
     
        
        
%%% 05/23/2019
figure('units','normalized','outerposition',[0 0 1 1]);
[ha, pos] = tight_subplot(2,2,[0.1 0.05],[.15 .05],[.05 .01]); 
axes(ha(1));
tlt = 'Harvested Area';
y_label = 'Harvested Area Changes (ha)';
h1 = RESULTS_decomp_graph05232019(portf.HARVST_Delta.*100,portf.HARVST_DeltaCO.*100,tlt,y_label,CN_Label,CR_Label);
xlim([0.3,7.7])

axes(ha(2));
tlt = 'Nitrogen Surplus';
y_label = 'Nitrogen Surplus Changes (Tg)';
h2 = RESULTS_decomp_graph05232019(Nitr.Nsur.Nsur_kg_Delta./1000000000,Nitr.Nsur.Nsur_kg_DeltaCO./1000000000,tlt,y_label,CN_Label,CR_Label);
xlim([0.3,7.7])

axes(ha(3));
tlt = 'Phosphorus Surplus';
y_label = 'Phosphorus Surplus Changes (Tg)';
h3 = RESULTS_decomp_graph05232019(Phos.Psur.Psur_kg_Delta./1000000000,Phos.Psur.Psur_kg_DeltaCO./1000000000,tlt,y_label,CN_Label,CR_Label);
xlim([0.3,7.7])

axes(ha(4));
tlt = 'Blue Water Use';
y_label = 'Blue Water Use Changes (L)';
h4 = RESULTS_decomp_graph05232019(Wat.Blue.BlueW_L_Delta,Wat.Blue.BlueW_L_DeltaCO,tlt,y_label,CN_Label,CR_Label);
xlim([0.3,7.7])

CRLABEL = horzcat(CR_Label1, "Total");
leg1 = legend(h4,CRLABEL);
newPosition = [0.37 0.05 0.3 0.04]
%[left bottom width height]
%set(leg1,'Position', newPosition,);
set(leg1,'Position', newPosition,'Orientation','horizontal', 'FontSize', 12)

        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
%%% Paralell bar graph
figure('units','normalized','outerposition',[0 0 1 1]);
Nsur_kgkm_bar(1:co_dim,1:2) = nan;
Nsur_kgkm_bar(1:co_dim,1) = Nitr2.Nsur.Nsur_kgkm_AggCO(:,:,yr_base);
Nsur_kgkm_bar(1:co_dim,2) = Nitr2.Nsur.Nsur_kgkm_ExpCO;
bar(Nsur_kgkm_bar);


tlt = 'Harvested Area Changes (km^2)';
y_label = 'Harvested Area Changes (km^2)';
filename = 'Harvested Area Changes GTAP';
CR_Label1 = ["Paddy Rice", "Wheat","Sorghum", "Oth CoarseGrain","Soybeans",...
            "Palm Fruit","Rapeseed","Oth Oilseeds","Sugar Crop","OthAgri"];
RESULTS_decomp_graph(HARVST_Delta,HARVST_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);

%%% Nitrogen Surplus Changes
%%% Adding global impacts
tlt = 'Regional Nitrogen Surplus Changes (kg)';
y_label = 'Regional Nitrogen Surplus Changes (kg)';
filename = 'Nirogen Surplus Changes GTAP Global';
RESULTS_decomp_graph(Nitr2.Nsur.Nsur_kg_Delta,Nitr2.Nsur.Nsur_kg_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);

Nsur_kg_Agg = Nitr2.Ninput.Ninput_kg_Agg - Nitr2.Nyield.Nyield_kg_Agg;
Nsur_kg_Exp = Nitr2.Ninput.Ninput_kg_Exp - Nitr2.Nyield.Nyield_kg_Exp;
Nsur_kg_Delta = Nsur_kg_Exp - Nsur_kg_Agg(:,:,yr_base);


Nsur_kg_AggCO = Nitr2.Ninput.Ninput_kg_AggCO - Nitr2.Nyield.Nyield_kg_AggCO;
Nsur_kg_ExpCO = Nitr2.Ninput.Ninput_kg_ExpCO - Nitr2.Nyield.Nyield_kg_ExpCO;
Nsur_kg_DeltaCO = Nsur_kg_ExpCO - Nsur_kg_AggCO(:,yr_base);

tlt = 'Regional Nitrogen Surplus Changes (kg)';
y_label = 'Regional Nitrogen Surplus Changes (kg)';
filename = 'Nirogen Surplus Changes GTAP Global';
RESULTS_decomp_graph(Nsur_kg_Delta,Nsur_kg_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);


%%% Phosphorus Surplus Changes
%%% Adding global impacts
tlt = 'Regional Phosphorus Surplus Changes (kg)';
y_label = 'Regional Phosphorus Surplus Changes (kg)';
filename = 'Phosphorus Surplus Changes GTAP Global';
RESULTS_decomp_graph(Phos2.Psur.Psur_kg_Delta,Phos2.Psur.Psur_kg_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);

%%% Nitrogen Use Efficiency Changes
y_label_left = 'N_o_u_t_p_u_t/N_i_n_p_u_t Changes';
y_label_right = 'N_o_u_t_p_u_t/N_i_n_p_u_t';
lgd = ["NUE Changes","Base Year","25% Tariff Increase"];
tlt = 'NUE Changes';
filename = 'NUE Changes GTAP';
RESULTS_changecomp_graph(Nitr2.NUE.NUE_AggCO(:,yr_base),Nitr2.NUE.NUE_ExpCO(:),Nitr2.NUE.NUE_DeltaCO,...
    Nitr2.NUE.NUE_AggGB(yr_base),Nitr2.NUE.NUE_ExpGB,Nitr2.NUE.NUE_DeltaGB,...
    tlt,y_label_left,y_label_right,lgd,filename,CN_Label,result_dir)

%%% Phosphorous Use Efficiency Changes
y_label_left = 'P_o_u_t_p_u_t/P_i_n_p_u_t Changes';
y_label_right = 'P_o_u_t_p_u_t/P_i_n_p_u_t';
lgd = ["PUE Changes","Base Year","20% Soybean Tariffs"];
tlt = 'PUE Changes';
filename = 'PUE Changes GTAP';
RESULTS_changecomp_graph(Phos2.PUE.PUE_AggCO(:,yr_base),Phos2.PUE.PUE_ExpCO(:),Phos2.PUE.PUE_DeltaCO,...
    Phos2.PUE.PUE_AggGB(yr_base),Phos2.PUE.PUE_ExpGB,Phos2.PUE.PUE_DeltaGB,...
    tlt,y_label_left,y_label_right,lgd,filename,CN_Label,result_dir)

%%% Water Depletion
tlt = 'Water Deleption Changes (L)';
y_label = 'Water Deleption Changes (L)';
filename = 'Water Depletion Changes Global';
RESULTS_decomp_graph(Wat2.h2oDeplete.h2oDeplete_Delta,Wat2.h2oDeplete.h2oDeplete_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);

%%% Water Use Efficiency Changes
y_label_left = 'Total Nitrogen Product/Water Use Depletion Changes';
y_label_right = 'Total Nitrogen Product/Water Use Depletion';
lgd = ["WUE Changes","Base Year","20% Soybean Tariffs"];
tlt = 'WUE Changes';
filename = 'WUE Changes GTAP';
RESULTS_changecomp_graph(Wat2.WUE.WUE_N_AggCO(:,yr_base),Wat2.WUE.WUE_N_ExpCO(:),Wat2.WUE.WUE_N_DeltaCO,...
    Wat2.WUE.WUE_N_AggGB(yr_base),Wat2.WUE.WUE_N_ExpGB,Wat2.WUE.WUE_N_DeltaGB,...
    tlt,y_label_left,y_label_right,lgd,filename,CN_Label,result_dir)


%%% Crop Revenue
%%% Adding global impacts
tlt = 'Crop Revenue Changes (US$)';
y_label = 'Regional Crop Revenue Changes(US$)';
filename = 'Crop Revnue GTAP Global';
RESULTS_decomp_graph(Econ2.Ag.Ag_Rev_Delta,Econ2.Ag.Ag_Rev_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);

%%% Self-sufficiency Rate
y_label_left = 'Self-Sufficiency Rate Changes';
y_label_right = 'Self-Sufficiency Rate';
lgd = ["SSR Changes","Base Year","20% Soybean Tariffs"];
tlt = 'Self-Sufficiency Rate Changes';
filename = 'SSR Changes GTAP';
CN_Label1 = ["USA","EU27","BRAZIL","CHINA","SoAmer","OTHER"];
RESULTS_changecomp_regional_graph(Soc2.SSR.SSR_N_AggCO(:,yr_base),Soc2.SSR.SSR_N_ExpCO(:),Soc2.SSR.SSR_N_Delta,...
    tlt,y_label_left,y_label_right,lgd,filename,CN_Label1,result_dir);

%%% Virtual and Alternative nitrogen decomposition

%%%%% Virtual:Decomposition based on crops
tlt = 'Virtual Area Changes (km^2) -- Decomposition based on crop types';
y_label = 'Virtual Area Changes (km^2)';
filename = 'Virtual Area Changes GTAP-Nitrogen';
RESULTS_decomp_graph(Nitr2.Vir.Narea_Vir_Delta,Nitr2.Vir.Narea_Vir_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);


%%%%% Virtual:Decomposition based on crops
tlt = 'Virtual Nitrogen Surplus Changes (kg N) -- Decomposition based on crop types';
y_label = 'Virtual Nitrogen Surplus Changes (kg N)';
filename = 'Virtual Nitrogen Surplus Changes GTAP';
RESULTS_decomp_graph(Nitr2.Vir.Nsur_Vir_Delta,Nitr2.Vir.Nsur_Vir_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);


%%%%% Alternative:Decomposition based on crops
tlt = 'Alternative Area Changes (km^2) -- Decomposition based on crop types';
y_label = 'Alternative Area Changes (km^2)';
filename = 'Alternative Area Changes GTAP - Nitrogen';
RESULTS_decomp_graph(Nitr2.Alt.Narea_Alt_Delta,Nitr2.Alt.Narea_Alt_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);


%%%%% Decomposition based on trade partnership
tlt = 'Virtual Area Changes (km^2) -- Decomposition based on Trade Partnership';
y_label = 'Virtual Area Changes (km^2)';
filename = 'Virtual Area Changes partner decomp GTAP';
LGD =  ["USA","EU27","BRAZIL","CHINA","SoAmer","OTHER"];
RESULTS_decomp_graph(Nitr2.Vir.BiNarea_Vir_DeltaCR,Nitr2.Vir.Narea_Vir_DeltaCO,tlt,y_label,filename,CN_Label,LGD,result_dir);

%%%%%%%%%%%%%%%%%%%%%%Phosphorus%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Virtual:Decomposition based on crops
tlt = 'Virtual Phosphorus Area Changes (km^2) -- Decomposition based on crop types';
y_label = 'Virtual Phosphorus Area Changes (km^2)';
filename = 'Virtual Phosphorus Area Changes GTAP';
RESULTS_decomp_graph(Phos2.Vir.Parea_Vir_Delta,Phos2.Vir.Parea_Vir_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);


%%%%% Virtual:Decomposition based on crops
tlt = 'Virtual Phosphorus Surplus Changes (kg N) -- Decomposition based on crop types';
y_label = 'Virtual Phosphorus Surplus Changes (kg N)';
filename = 'Virtual Phosphorus Surplus Changes GTAP';
RESULTS_decomp_graph(Phos2.Vir.Psur_Vir_Delta,Phos2.Vir.Psur_Vir_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);


%%%%% Decomposition based on trade partnership
tlt = 'Virtual Area Changes (km^2) -- Decomposition based on Trade Partnership-Phosphorus';
y_label = 'Virtual Area Changes (km^2)';
filename = 'Virtual Area Changes partner decomp GTAP';
LGD =  ["USA","EU27","BRAZIL","CHINA","SoAmer","OTHER"];
RESULTS_decomp_graph(Phos2.Vir.BiParea_Vir_DeltaCR,Phos2.Vir.Parea_Vir_DeltaCO,tlt,y_label,filename,CN_Label,LGD,result_dir);

%%%% Calorie supply changes
tlt = 'Caloric production changes (kcal)by primary crop types';
y_label = 'Caloric production changes (kcal)';
filename = 'Caloric production Changes GTAP';
RESULTS_decomp_graph(Nutri2.Calor.CalorProd_Delta,Nutri2.Calor.CalorProd_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);

%%%% Calorie available to the domestic consumers
tlt = 'Caloric production and net imports changes(kcal) by primary crop types';
y_label = 'Caloric production and net imports changes (kcal)';
filename = 'Caloric production and net imports Changes GTAP';
RESULTS_decomp_graph(Nutri2.Calor.CalorPNIm_Delta,Nutri2.Calor.CalorPNIm_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);


%%%% Protein supply changes
tlt = 'Protein production changes(g) by primary crop types';
y_label = 'Protein production changes (kg)';
filename = 'Protein production Changes GTAP';
RESULTS_decomp_graph(Nutri2.Prot.ProtProd_Delta,Nutri2.Prot.ProtProd_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);

%%%% Protein available to the domestic consumers
tlt = 'Protein production and net imports changes (g) by primary crop types';
y_label = 'Protein production and net imports changes (g)';
filename = 'Protein production and net imports Changes GTAP';
RESULTS_decomp_graph(Nutri2.Prot.ProtPNIm_Delta,Nutri2.Prot.ProtPNIm_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);


%%%% Fat supply changes
tlt = 'Fat production changes (g) by primary crop types';
y_label = 'Fat production changes (kg)';
filename = 'Fat production Changes GTAP';
RESULTS_decomp_graph(Nutri2.Fat.FatProd_Delta,Nutri2.Fat.FatProd_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);

%%%% Fat available to the domestic consumers
tlt = 'Fat production and net imports changes (g) by primary crop types';
y_label = 'Fat production and net imports changes (g)';
filename = 'Fat production and net imports Changes GTAP';
RESULTS_decomp_graph(Nutri2.Fat.FatPNIm_Delta,Nutri2.Fat.FatPNIm_DeltaCO,tlt,y_label,filename,CN_Label,CR_Label,result_dir);



%%%% Calculate the percentage changes of one indicator and draw a bar
%%%% chart

%% update 09172019
Nsur_kg_AggGB = Nitr2.Nsur.Nsur_kg_AggGB(:,yr_base);
Nsur_kg_DeltaGB = Nitr2.Nsur.Nsur_kg_DeltaGB;

Nsur_kg_AggCO = Nitr2.Nsur.Nsur_kg_AggCO(:,yr_base);
Nsur_kg_DeltaCO = Nitr2.Nsur.Nsur_kg_DeltaCO;

Nsur_kgkm_AggGB = Nsur_kg_AggGB./ nansum(nansum(AreaH_FAO_Agg(:,1:10,yr_base)));
Nsur_kgkm_ExpGB = Nitr2.Nsur.Nsur_kg_ExpGB ./nansum(nansum(harvst_new2(:,1:10)));
Nsur_kgkm_DeltaGB = Nsur_kgkm_ExpGB - Nsur_kgkm_AggGB;

Nsur_kgkm_AggCO = Nsur_kg_AggCO./ nansum(AreaH_FAO_Agg(:,1:10,yr_base),2);
Nsur_kgkm_ExpCO = Nitr2.Nsur.Nsur_kg_ExpCO./ nansum(harvst_new2(:,1:10),2);
Nsur_kgkm_DeltaCO = Nsur_kgkm_ExpCO - Nsur_kgkm_AggCO;


Ninput_kgkm_AggGB = Nitr2.Ninput.Ninput_kg_AggGB(:,yr_base) ./nansum(nansum(AreaH_FAO_Agg(:,1:10,yr_base)));
Nyield_kgkm_AggGB = Nitr2.Nyield.Nyield_kg_AggGB(:,yr_base) ./nansum(nansum(AreaH_FAO_Agg(:,1:10,yr_base)));
NUE_AggGB = Nyield_kgkm_AggGB./Ninput_kgkm_AggGB;

Ninput_kgkm_ExpGB = Nitr2.Ninput.Ninput_kg_ExpGB ./nansum(nansum(harvst_new2(:,1:10)));
Nyield_kgkm_ExpGB = Nitr2.Nyield.Nyield_kg_ExpGB ./nansum(nansum(harvst_new2(:,1:10)));
NUE_ExpGB = Nyield_kgkm_ExpGB./Ninput_kgkm_ExpGB;

NUE_DeltaGB = NUE_ExpGB - NUE_AggGB;

Ninput_kgkm_AggCO = Nitr2.Ninput.Ninput_kg_AggCO ./nansum(AreaH_FAO_Agg(:,1:10,yr_base),2);
Nyield_kgkm_AggCO = Nitr2.Nyield.Nyield_kg_AggCO ./nansum(AreaH_FAO_Agg(:,1:10,yr_base),2);


%%P
Psur_kg_ExpGB = Phos2.Psur.Psur_kg_AggGB(:,yr_base)+ Phos2.Psur.Psur_kg_DeltaGB;
Psur_kgkm_ExpGB = Psur_kg_ExpCO./nansum(nansum(harvst_new2(:,1:10),2),1);
Psur_kgkm_AggGB = Phos2.Psur.Psur_kg_AggGB(:,yr_base)./nansum(nansum(AreaH_FAO_Agg(:,1:10,yr_base),2),1);
Psur_kgkm_DeltaGB = Psur_kgkm_ExpGB - Psur_kgkm_AggGB;

Psur_kg_ExpCO = Phos2.Psur.Psur_kg_AggCO(:,yr_base)+ Phos2.Psur.Psur_kg_DeltaCO;
Psur_kgkm_ExpCO = Psur_kg_ExpCO./nansum(harvst_new2(:,1:10),2);
Psur_kgkm_AggCO = Phos2.Psur.Psur_kg_AggCO(:,yr_base)./nansum(AreaH_FAO_Agg(:,1:10,yr_base),2);
Psur_kgkm_DeltaCO = Psur_kgkm_ExpCO - Psur_kgkm_AggCO;


Nsur_PC2(1,1) = -percent_changes(Nitr2.Nsur.Nsur_kg_AggGB(:,yr_base),Nitr2.Nsur.Nsur_kg_DeltaGB);
Nsur_PC2(2:7) = -percent_changes(Nitr2.Nsur.Nsur_kg_AggCO(:,yr_base),Nitr2.Nsur.Nsur_kg_DeltaCO);

NsurI_PC2(1,1) = -percent_changes(Nsur_kgkm_AggGB(:,yr_base),Nsur_kgkm_DeltaGB);
NsurI_PC2(2:7) = -percent_changes(Nitr2.Nsur.Nsur_kgkm_AggCO(:,yr_base),Nitr2.Nsur.Nsur_kgkm_DeltaCO);

NUE_PC2(1,1) = percent_changes(Nitr2.NUE.NUE_AggGB(:,yr_base),Nitr2.NUE.NUE_DeltaGB);
NUE_PC2(2:7) = percent_changes(Nitr2.NUE.NUE_AggCO(:,yr_base),Nitr2.NUE.NUE_DeltaCO);

Psur_PC2(1,1) = -percent_changes(Phos2.Psur.Psur_kg_AggGB(:,yr_base),Phos2.Psur.Psur_kg_DeltaGB);
Psur_PC2(2:7) = -percent_changes(Phos2.Psur.Psur_kg_AggCO(:,yr_base),Phos2.Psur.Psur_kg_DeltaCO);

%Original
PsurI_PC2(1,1) = -percent_changes(Phos2.Psur.Psur_kgkm_AggGB(:,yr_base),Phos2.Psur.Psur_kgkm_DeltaGB);
PsurI_PC2(2:7) = -percent_changes(Phos2.Psur.Psur_kgkm_AggCO(:,yr_base),Phos2.Psur.Psur_kgkm_DeltaCO);

%Updated
PsurI_PC2(1,1) = -percent_changes(Psur_kgkm_AggGB,Psur_kgkm_DeltaGB);
PsurI_PC2(2:7) = -percent_changes(Psur_kgkm_AggCO,Psur_kgkm_DeltaCO);

PUE_PC2(1,1) = percent_changes(Phos2.PUE.PUE_AggGB(:,yr_base),Phos2.PUE.PUE_DeltaGB);
PUE_PC2(2:7) = percent_changes(Phos2.PUE.PUE_AggCO(:,yr_base),Phos2.PUE.PUE_DeltaCO);

%h2oDep_PC2 = -percent_changes(Wat2.h2oDeplete.h2oDeplete_L_AggCO(:,yr_base),Wat2.h2oDeplete.h2oDeplete_L_DeltaCO);
%h2oDep_PC2(7,1) = -percent_changes(Wat2.h2oDeplete.h2oDeplete_L_AggGB(:,yr_base),Wat2.h2oDeplete.h2oDeplete_L_DeltaGB);

%Wat2.h2oDeplete.h2oDeplete_DeltaCO = Wat2.h2oDeplete.h2oDeplete_ExpCO - Wat2.h2oDeplete.h2oDeplete_AggCO(:,yr_base);
%Wat2.h2oDeplete.h2oDeplete_DeltaGB = Wat2.h2oDeplete.h2oDeplete_ExpGB - Wat2.h2oDeplete.h2oDeplete_AggGB(:,yr_base);

%h2oDepI_PC2 = -percent_changes(Wat2.h2oDeplete.h2oDeplete_AggCO(:,yr_base),Wat2.h2oDeplete.h2oDeplete_DeltaCO);
%h2oDepI_PC2(7,1) = -percent_changes(Wat2.h2oDeplete.h2oDeplete_AggGB(:,yr_base),Wat2.h2oDeplete.h2oDeplete_DeltaGB);

%WUE_PC2 = percent_changes(Wat2.WUE.WUE_AggCO(:,yr_base),Wat2.WUE.WUE_DeltaCO);
%WUE_PC2(1,1) = percent_changes(Wat2.WUE.WUE_AggGB(:,yr_base),Wat2.WUE.WUE_DeltaGB);

BWater_PC2(1,1) = -percent_changes(Wat2.Blue.BlueW_L_AggGB(:,yr_base),Wat2.Blue.BlueW_L_DeltaGB);
BWater_PC2(2:7) = -percent_changes(Wat2.Blue.BlueW_L_AggCO(:,yr_base),Wat2.Blue.BlueW_L_DeltaCO);

Wat2.Blue.BlueW_DeltaCO = Wat2.Blue.BlueW_ExpCO - Wat2.Blue.BlueW_AggCO(:,yr_base);
Wat2.Blue.BlueW_DeltaGB = Wat2.Blue.BlueW_ExpGB - Wat2.Blue.BlueW_AggGB(:,yr_base);

BWaterI_PC2(1,1) = -percent_changes(Wat2.Blue.BlueW_AggGB(:,yr_base),Wat2.Blue.BlueW_DeltaGB);
BWaterI_PC2(2:7) = -percent_changes(Wat2.Blue.BlueW_AggCO(:,yr_base),Wat2.Blue.BlueW_DeltaCO);

BWUE_PC2(1,1) = percent_changes(Wat2.BWUE.BWUE_AggGB(:,yr_base),Wat2.BWUE.BWUE_DeltaGB);
BWUE_PC2(2:7) = percent_changes(Wat2.BWUE.BWUE_AggCO(:,yr_base),Wat2.BWUE.BWUE_DeltaCO);

TopS_PC2 = -percent_changes(Soc2.TopS.Area_Top2(:,yr_base),Soc2.TopS.Area_Top2_DeltaCO);

Soc2.SSR.SSR_N_DeltaCO = Soc2.SSR.SSR_N_ExpCO - Soc2.SSR.SSR_N_AggCO(:,yr_base);


CrRev_PC2 = percent_changes(Econ2.Ag.Ag_Rev_AggCO(:,yr_base),Econ2.Ag.Ag_Rev_DeltaCO);
CalP_PC2 = percent_changes(Nutri2.Calor.CalorProd_AggCO(:,yr_base),Nutri2.Calor.CalorProd_DeltaCO);
CalPN_PC2 = percent_changes(Nutri2.Calor.CalorPNIm_AggCO(:,yr_base),Nutri2.Calor.CalorPNIm_DeltaCO);
ProtP_PC2 = percent_changes(Nutri2.Prot.ProtProd_AggCO(:,yr_base),Nutri2.Prot.ProtProd_DeltaCO);
ProtPN_PC2 = percent_changes(Nutri2.Prot.ProtPNIm_AggCO(:,yr_base),Nutri2.Prot.ProtPNIm_DeltaCO);
Fat_PC2 = percent_changes(Nutri2.Fat.FatProd_AggCO(:,yr_base),Nutri2.Fat.FatProd_DeltaCO);
FatPN_PC2 = percent_changes(Nutri2.Fat.FatPNIm_AggCO(:,yr_base),Nutri2.Fat.FatPNIm_DeltaCO);


stacked_inds2 = [Nsur_PC2;NsurI_PC2;;Psur_PC2;PsurI_PC2;BWater_PC2;...
    BWaterI_PC2];
stacked_inds_t = transpose(stacked_inds2);

stacked_inds_t_pos = stacked_inds_t;
stacked_inds_t_pos(stacked_inds_t_pos<0) = 0;


stacked_inds_t_neg = stacked_inds_t;
stacked_inds_t_neg(stacked_inds_t_pos>0) = 0;

%                   or [gap_h gap_w] for different gaps in height and width 
%        marg_h  margins in height in normalized units (0...1)
%                   or [lower upper] for different lower and upper margins 
%        marg_w  margins in width in normalized units (0...1)
%                   or [left right] for different left and right margins 
%%% Paralell bar graph
figure('units','normalized','outerposition',[0 0 1 1]);
[ha, pos] = tight_subplot(7,1,[0.02 0],[.15 .05],[.05 .01]) 

x = 1:6;
for i = 1:1:7
axes(ha(i));
bp(i) = bar(x,stacked_inds_t_pos(i,:),'FaceColor',[0.4660    0.6740    0.1880],'EdgeColor',[0.4660    0.6740    0.1880],'BarWidth',0.5);
hold on;
bn(i) = bar(x,stacked_inds_t_neg(i,:),'FaceColor',[0.6350    0.0780    0.1840],'EdgeColor',[0.6350    0.0780    0.1840],'BarWidth',0.5);
    if i<7
    set(gca,'xtick',[])
    set(gca,'xticklabel',[])
    set(gca,'FontSize',11)
    else
        set(gca,'FontSize',11)
        set(gca,'xticklabel',{"-Nsur","-Nsur Intensity","-Psur","-Psur Intensity","-BlueW","-BlueW Intensity"},'FontSize',11)
    end
xlim([0.4,6.6])
%label_inds = ["Nsur","Psur","WaterDepletion","NUE","PUE","Crop Revenue","Self-sufficiency Rate"];
%legend(label_inds);
%xticklabels(CN_Label1);
set(gca,'box','off')

ylabel(CN_Label(i),'FontSize',12)

end
h = [bp(1),bn(1)];


hlabel = {"Sustainable Changes","Unsustainable Changes"};
hleg = legend(h,hlabel);
newPosition = [0.37 0.05 0.3 0.04];
%[left bottom width height]
%set(leg1,'Position', newPosition,);
set(hleg,'Position', newPosition,'Orientation','horizontal', 'FontSize', 12)



stacked_inds_trans2 = transpose(stacked_inds2);
figure(1)
subplot(3,1,1)
bar(stacked_inds2(1,:));
subplot(3,1,2)
bar(stacked_inds2(2,:));
subplot(3,1,3)
bar(stacked_inds2(3,:));

% Argentina, Bolivia, Paraguay 
ABP = [7, 23, 148];
check_PUE = nansum(nansum(AreaH_FAO(ABP,:,56),2),1)./nansum(AreaH_FAO_Agg(5,:,56),2);
Pinput_kgkm =  Pfer_kgkm + Pman_kgkm;
Psur_kgkm = Pinput_kgkm - Pyield_kgkm;
PUE = Pyield_kgkm ./Ninput_kgkm;